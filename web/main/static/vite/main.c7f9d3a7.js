var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,s=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,r=(e,r)=>{for(var i in r||(r={}))t.call(r,i)&&s(e,i,r[i]);if(a)for(var i of a(r))n.call(r,i)&&s(e,i,r[i]);return e};import{c as i,p as l,a as o,r as c,o as d,b as u,d as p,t as h,F as m,e as g,w as _,f as b,g as f,h as v,i as y,j as w,k,l as x,m as C,n as A,v as T,q as L,s as S,u as P,x as D,y as U,z as I,A as F}from"./vendor.aaf8c599.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,r)=>{const i=new URL(e,n);if(self[t].moduleMap[i])return a(self[t].moduleMap[i]);const l=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),o=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){r(new Error(`Failed to import: ${e}`)),s(o)},onload(){a(self[t].moduleMap[i]),s(o)}});document.head.appendChild(o)})),self[t].moduleMap={}}}("/static/vite/");const{mapState:E,mapActions:W}=i("user");var z={computed:E(["first_name","is_authenticated","is_staff"]),methods:r(r({},W(["logout"])),{doLogout(e){return this.logout(e).then((()=>this.$router.push({name:"logout"})))}})};const j=b();l("data-v-8d91372a");const H={key:0,class:"dropdown"},R={class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdown-menu-nav","data-bs-toggle":"dropdown","aria-expanded":"false"},q={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown-menu-nav"},M=f("Dashboard"),O=f("My Account"),$=f("User Guide"),B=p("li",null,[p("hr",{class:"dropdown-divider"})],-1),V=p("li",null,[p("span",{class:"h6 dropdown-header"},"Admin Only")],-1),Z=p("li",null,[p("a",{class:"dropdown-item",href:"/admin/"},"Django Admin")],-1),N=p("li",null,[p("hr",{class:"dropdown-divider"})],-1),K=p("button",{type:"submit",class:"dropdown-item"},"Log out",-1),G={key:1,class:"navbar-nav"},Y={class:"nav-item"},X=f("Sign up"),J={class:"nav-item"},Q=f("User Guide"),ee={class:"nav-item"},te=f("Log in");o();const ae=j(((e,t,a,n,s,r)=>{const i=c("router-link");return e.is_authenticated?(d(),u("div",H,[p("button",R,h(e.first_name),1),p("ul",q,[p("li",null,[p(i,{to:{name:"root"},class:"dropdown-item"},{default:j((()=>[M])),_:1})]),p("li",null,[p(i,{to:{name:"account"},class:"dropdown-item"},{default:j((()=>[O])),_:1})]),p("li",null,[p(i,{to:{name:"docs"},class:"dropdown-item"},{default:j((()=>[$])),_:1})]),e.is_staff?(d(),u(m,{key:0},[B,V,Z],64)):g("",!0),N,p("li",null,[p("form",{onSubmit:t[1]||(t[1]=_(((...e)=>r.doLogout&&r.doLogout(...e)),["prevent"]))},[K],32)])])])):(d(),u("ul",G,[p("li",Y,[p(i,{to:{name:"sign_up"},class:"nav-link"},{default:j((()=>[X])),_:1})]),p("li",J,[p(i,{to:{name:"docs"},class:"nav-link"},{default:j((()=>[Q])),_:1})]),p("li",ee,[p(i,{to:{name:"login"},class:"nav-link"},{default:j((()=>[te])),_:1})])]))}));z.render=ae,z.__scopeId="data-v-8d91372a";i("globals");const ne={components:{TheMainNav:z}},se={class:"navbar navbar-expand-lg"},re={class:"container-fluid"},ie=p("img",{alt:"Perma logo",title:"Perma logo",src:"/static/vite/perma-logo.6b161a6e.svg"},null,-1),le=p("span",{class:"wordmark"},"Perma Capture",-1);ne.render=function(e,t,a,n,s,r){const i=c("router-link"),l=c("TheMainNav");return d(),u("nav",se,[p("div",re,[p(i,{to:{name:"root"},class:"navbar-brand"},{default:v((()=>[ie,le])),_:1}),p(l)])])};const oe={name:"Footer"},ce={class:"page-footer"},de=y('<div><div class="attribution">Perma Capture is a project of the Harvard Law School <a href="https://lil.law.harvard.edu">Library Innovation Lab</a>.</div><div class="copyright">Â©2021 The President and Fellows of Harvard University.</div><a class="a11y-policy" href="https://accessibility.huit.harvard.edu/digital-accessibility-policy"><span aria-hidden="true">â™¿</span><span class="visually-hidden">Accessibility policy</span></a></div>',1);oe.render=function(e,t,a,n,s,r){return d(),u("footer",ce,[de])};var ue=w({name:"App",components:{TheNavbar:ne,TheFooter:oe}});ue.render=function(e,t,a,n,s,r){const i=c("TheNavbar"),l=c("router-view"),o=c("TheFooter");return d(),u(m,null,[p(i),p("main",null,[p(l)]),p(o)],64)};var pe={namespaced:!0,state:r({},store_bootstrap.globals),getters:{},actions:{},mutations:{}};function he(e=""){return e.split("_").map((e=>e.slice(0,1).toUpperCase()+e.slice(1))).join("")}function me(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}let ge={"Content-Type":"application/json",Accept:"application/json"};const _e=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),n=0;n<a.length;n++){var s=a[n].trim();if(s.substring(0,e.length+1)===e+"="){t=decodeURIComponent(s.substring(e.length+1));break}}return t}("csrftoken");_e&&(ge["X-CSRFToken"]=_e);const be=k.create({headers:ge,paramsSerializer:e=>x.stringify(e,{arrayFormat:"comma"})});be.interceptors.response.use((e=>{var t,a;return!1===(null==(a=null==(t=e.data)?void 0:t.form)?void 0:a.is_valid)?Promise.reject(e.data.form.errors):e}));var fe,ve,ye,we,ke,xe,Ce={namespaced:!0,state:r({},store_bootstrap.user),getters:{},actions:{signup:(e,t)=>be.post("/sign-up/",t,{headers:{"Content-Type":"multipart/form-data"}}),update:({commit:e},t)=>be.post("/user/account/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{e("update",t.data.form.data)})),login:(e,t)=>be.post("/user/login/",t,{headers:{"Content-Type":"multipart/form-data"}}),logout:({commit:e})=>be.post("/user/logout/",{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{e("logout")})),resetPassword:(e,t)=>be.post("/user/password_reset/",t,{headers:{"Content-Type":"multipart/form-data"}}),changePassword:(e,t)=>be.post("/user/password_change/",t,{headers:{"Content-Type":"multipart/form-data"}}),resetToken:({commit:e})=>be.post("/user/token_reset/").then((t=>{e("updateToken",t.data.token)}))},mutations:{update:(e,t)=>Object.assign(e,t),updateToken:(e,t)=>e.auth_token.key=t,logout:e=>e.is_authenticated=!1}};(ve=fe||(fe={}))[ve.Pending=0]="Pending",ve[ve.InProgress=1]="InProgress",(we=ye||(ye={}))[we.Invalid=0]="Invalid",we[we.Failed=1]="Failed",(xe=ke||(ke={}))[xe.Completed=0]="Completed";const Ae=e=>t=>(a,n)=>{if(t){const e=a;a=n,n=e}return a[e]<n[e]?-1:a[e]>n[e]?1:a.id<n.id?-1:a.id>n.id?1:0},Te={url:e=>{const t=Ae("url")(e);return(e,a)=>t(r(r({},e),{url:e.validated_url||e.requested_url}),r(r({},a),{url:a.validated_url||a.requested_url}))},created_at:e=>{const t=Ae("created_at")(e);return(e,a)=>t(r(r({},e),{created_at:new Date(e.created_at)}),r(r({},a),{created_at:new Date(a.created_at)}))}};var Le=C({modules:{globals:pe,user:Ce,captures:{namespaced:!0,state:{all:[],apiContext:{count:null,next:null,previous:null}},getters:{getByProperties:e=>t=>e.all.find((e=>Object.keys(t).reduce(((a,n)=>a&&t[n]==e[n]),!0))),sortedBy:e=>(t,a=!0)=>e.all.sort((Te[t]||Ae(t))(a)),processing:e=>e.all.filter((e=>he(e.status)in fe))},actions:{list:({commit:e},t={ordering:"-created_at",limit:10})=>be.get("/captures/",{params:t}).then((t=>{e("updateApiContext",t.data),e("replace",t.data.results)})),pageForward:({commit:e,state:t})=>be.get(t.apiContext.next).then((t=>{e("updateApiContext",t.data),e("append",t.data.results)})),create:({commit:e},t)=>be.post("/captures/",t).then((t=>{e("append",t.data)})),read:({commit:e,getters:t},a)=>be.get(`/captures/${a.id}`).then((n=>{const s=t.getByProperties({id:a.id});s?e("update",{obj:s,vals:n.data}):e("append",[n.data])})),batchRead:({commit:e,getters:t},a)=>be.get("/captures/",{params:{id__in:a.map((({id:e})=>e))}}).then((n=>{for(const[s,r]of n.data.results.entries()){const n=t.getByProperties({id:a[s].id});n?e("update",{obj:n,vals:r}):e("append",[r])}})),eagerCreateAndUpdate:({commit:e,getters:t},a)=>{e("append",a),be.post("/captures/",a).then((n=>{for(const[s,r]of n.data.entries())e("update",{obj:t.getByProperties({created_at:a[s].created_at}),vals:r})}))}},mutations:{updateApiContext:(e,t)=>{return Object.assign(e.apiContext,(a=Object.keys(e.apiContext),n=t,a.reduce(((e,t)=>(e[t]=n[t],e)),{})));var a,n},replace:(e,t)=>e.all=t,append:(e,t)=>e.all.push(...t),update:(e,t)=>Object.assign(t.obj,t.vals),destroy:(e,t)=>e.all.splice(e.all.indexOf(t),1)}}},state:{displayedCapture:void 0,breakpoints:{xs:575,sm:767,md:991,lg:1199,xl:1399},windowWidth:"xl",viewportHeight:0},mutations:{setDisplayedCapture:(e,t)=>{e.displayedCapture=t},setWindowWidth:e=>{window.innerWidth<=e.breakpoints.xs?e.windowWidth="xs":window.innerWidth<=e.breakpoints.sm?e.windowWidth="sm":window.innerWidth<=e.breakpoints.md?e.windowWidth="md":window.innerWidth<=e.breakpoints.lg?e.windowWidth="lg":e.windowWidth="xl"},setViewportHeight:e=>{e.viewportHeight=Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},actions:{},getters:{displayedCapture:e=>e.displayedCapture,isMobile:e=>"md"===e.windowWidth||"sm"===e.windowWidth||"xs"===e.windowWidth,isSmallestScreen:e=>"xs"===e.windowWidth,viewportHeight:e=>e.viewportHeight}});const{mapActions:Se}=i("captures");var Pe={data:()=>({requested_urls:"",label:"",include_raw_exchanges:!1,include_screenshot:!0,include_pdf_snapshot:!1,include_dom_snapshot:!1,include_videos_as_attachment:!0,include_certificates_as_attachment:!0,run_site_specific_behaviors:!0,headless:!0}),computed:{formatted_urls(){return this.requested_urls.trim().split("\n")}},methods:r(r({},Se(["eagerCreateAndUpdate"])),{submit(){this.eagerCreateAndUpdate(this.formatted_urls.map((e=>({requested_url:e,label:this.label,include_raw_exchanges:this.include_raw_exchanges,include_screenshot:this.include_screenshot,include_pdf_snapshot:this.include_pdf_snapshot,include_dom_snapshot:this.include_dom_snapshot,include_videos_as_attachment:this.include_videos_as_attachment,include_certificates_as_attachment:this.include_certificates_as_attachment,run_site_specific_behaviors:this.run_site_specific_behaviors,headless:this.headless,created_at:(new Date).toISOString()})))),this.requested_urls="",this.label=""}})};const De={class:"form-content"},Ue=p("h1",null,"Create a capture for download",-1),Ie=p("h2",{class:"subtitle"},"Enter one or more URLs to capture it in a downloadable archive.",-1),Fe={class:"mb-3"},Ee={class:"mb-3"},We={class:"mb-3 accordion",id:"advanced-options-wrapper"},ze={class:"accordion-item"},je=p("div",{class:"accordion-header",id:"toggle-advanced-options"},[p("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#advanced-options","aria-expanded":"true","aria-controls":"advanced-options"}," Advanced Options ")],-1),He={id:"advanced-options",class:"accordion-collapse collapse","aria-labelledby":"toggle-advanced-options","data-bs-parent":"#advanced-options-wrapper"},Re={class:"accordion-body"},qe={clas:"form-check"},Me=p("input",{name:"include_raw_exchanges",type:"hidden",value:"false"},null,-1),Oe=p("label",{for:"include_raw_exchanges",class:"form-check-label"},"include raw exchanges",-1),$e={clas:"form-check"},Be=p("input",{name:"screenshot",type:"hidden",value:"false"},null,-1),Ve=p("label",{for:"include_screenshot",class:"form-check-label"},"include screenshot",-1),Ze={clas:"form-check"},Ne=p("input",{name:"include_pdf_snapshot",type:"hidden",value:"false"},null,-1),Ke=p("label",{for:"include_pdf_snapshot",class:"form-check-label"},"include PDF snapshot",-1),Ge={clas:"form-check"},Ye=p("input",{name:"include_dom_snapshot",type:"hidden",value:"false"},null,-1),Xe=p("label",{for:"include_dom_snapshot",class:"form-check-label"},"include DOM snapshot",-1),Je={clas:"form-check"},Qe=p("input",{name:"include_videos_as_attachment",type:"hidden",value:"false"},null,-1),et=p("label",{for:"include_videos_as_attachment",class:"form-check-label"},"include videos as attachments",-1),tt={clas:"form-check"},at=p("input",{name:"include_certificates_as_attachment",type:"hidden",value:"false"},null,-1),nt=p("label",{for:"include_certificates_as_attachment",class:"form-check-label"},"include SSL certs as attachments",-1),st={clas:"form-check"},rt=p("input",{name:"run_site_specific_behaviors",type:"hidden",value:"false"},null,-1),it=p("label",{for:"run_site_specific_behaviors",class:"form-check-label"},"run site-specific behaviors during capture",-1),lt={clas:"form-check"},ot=p("input",{name:"headless",type:"hidden",value:"false"},null,-1),ct=p("label",{for:"headless",class:"form-check-label"},"use a headless browser for capture",-1),dt=p("div",{class:"form-submit-container"},[p("button",{type:"submit",class:"btn btn-primary btn-create"},"Create"),p("span",{class:"warning-text"},[f("Captures expire "),p("u",null,"four hours"),f(" after creation.")])],-1);Pe.render=function(e,t,a,n,s,r){return d(),u("form",{ref:"form",class:"capture-form",onSubmit:t[11]||(t[11]=_(((...e)=>r.submit&&r.submit(...e)),["prevent"])),onKeydown:[t[12]||(t[12]=S(_(((...e)=>r.submit&&r.submit(...e)),["shift","exact","prevent"]),["enter"])),t[13]||(t[13]=S(_(((...e)=>r.submit&&r.submit(...e)),["meta","exact","prevent"]),["enter"]))]},[p("div",De,[Ue,Ie,p("div",Fe,[A(p("textarea",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.requested_urls=t),id:"requested_urls",class:"form-control",rows:"3",required:"",placeholder:"Enter one or more URLs on each line","aria-label":"Enter one or more URLs on each line"},null,512),[[T,e.requested_urls]])]),p("div",Ee,[A(p("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.label=t),"aria-label":"Label (Optional)",placeholder:"Label (Optional)",id:"label",type:"text",class:"form-control"},null,512),[[T,e.label]])]),p("div",We,[p("div",ze,[je,p("div",He,[p("div",Re,[p("div",qe,[Me,A(p("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.include_raw_exchanges=t),id:"include_raw_exchanges",type:"checkbox",class:"form-check-input"},null,512),[[L,e.include_raw_exchanges]]),Oe]),p("div",$e,[Be,A(p("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.include_screenshot=t),id:"include_screenshot",name:"include_screenshot",type:"checkbox",class:"form-check-input"},null,512),[[L,e.include_screenshot]]),Ve]),p("div",Ze,[Ne,A(p("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.include_pdf_snapshot=t),id:"include_pdf_snapshot",name:"include_pdf_snapshot",type:"checkbox",class:"form-check-input"},null,512),[[L,e.include_pdf_snapshot]]),Ke]),p("div",Ge,[Ye,A(p("input",{"onUpdate:modelValue":t[6]||(t[6]=t=>e.include_dom_snapshot=t),id:"include_dom_snapshot",name:"include_dom_snapshot",type:"checkbox",class:"form-check-input"},null,512),[[L,e.include_dom_snapshot]]),Xe]),p("div",Je,[Qe,A(p("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.include_videos_as_attachment=t),id:"include_videos_as_attachment",name:"include_videos_as_attachment",type:"checkbox",class:"form-check-input"},null,512),[[L,e.include_videos_as_attachment]]),et]),p("div",tt,[at,A(p("input",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.include_certificates_as_attachment=t),id:"include_certificates_as_attachment",name:"include_certificates_as_attachment",type:"checkbox",class:"form-check-input"},null,512),[[L,e.include_certificates_as_attachment]]),nt]),p("div",st,[rt,A(p("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.run_site_specific_behaviors=t),id:"run_site_specific_behaviors",name:"run_site_specific_behaviors",type:"checkbox",class:"form-check-input"},null,512),[[L,e.run_site_specific_behaviors]]),it]),p("div",lt,[ot,A(p("input",{"onUpdate:modelValue":t[10]||(t[10]=t=>e.headless=t),id:"headless",name:"headless",type:"checkbox",class:"form-check-input"},null,512),[[L,e.headless]]),ct])])])])]),dt])],544)};const ut={name:"CaptureDetail",computed:{size(){return this.displayedCapture.archive?Number((this.displayedCapture.archive.size/1048576).toFixed(2)):0},expiresAt(){return this.displayedCapture.archive?new Date(this.displayedCapture.archive.download_expiration_timestamp):null},succeeded(){return he(this.displayedCapture.status||"pending")in ke},isMobile(){return this.$store.getters.isMobile},displayedCapture(){return this.$store.getters.displayedCapture}},methods:{getDate:e=>me(e),getArchiveAttribute(e){if(this.displayedCapture.archive)return this.displayedCapture.archive[e]}}},pt={key:0,class:"capture-detail-container"},ht={key:0,class:"data-group"},mt=p("br",null,null,-1),gt={key:0},_t={key:1},bt={key:1,class:"data-group download-button-group"},ft={class:"float-end"},vt={class:"data-group"},yt=p("h3",{class:"h6"},"Requested URL",-1),wt={key:2,class:"data-group"},kt=p("h3",{class:"h6"},"Labels",-1),xt={key:3,class:"data-group"},Ct=p("h3",{class:"h6"},"Error Message",-1),At={class:"contextItem"},Tt={class:"alert alert-danger"},Lt={key:4,class:"data-group"},St=p("h3",{class:"h6"},"Screenshot",-1),Pt={key:5,class:"data-group"},Dt=p("h3",{class:"h6"},"Replay",-1),Ut={class:"iframe-container"},It={key:6,class:"data-group"},Ft=p("h3",{class:"h6"},"Capture size",-1),Et={key:7,class:"data-group"},Wt=p("h3",{class:"h6"},"Title",-1),zt={key:8,class:"data-group"},jt=p("h3",{class:"h6"},"Description",-1),Ht={key:9,class:"data-group"},Rt=p("h3",{class:"h6"},"Content Type",-1),qt={key:10,class:"data-group"},Mt=p("h3",{class:"h6"},"Summary",-1);ut.render=function(e,t,a,n,s,r){return r.displayedCapture?(d(),u("div",pt,[r.isMobile?(d(),u("div",ht,[p("span",null,"Submitted "+h(r.getDate(r.displayedCapture.created_at)),1),mt,r.getArchiveAttribute("download_url")?(d(),u("span",gt,"Expires "+h(r.getDate(r.expiresAt)),1)):r.succeeded?(d(),u("span",_t,"Expired "+h(r.getDate(r.expiresAt)),1)):g("",!0)])):(d(),u("div",bt,[p("span",ft,[r.getArchiveAttribute("download_url")?(d(),u("a",{key:0,class:"btn bi bi-download download-button",href:r.getArchiveAttribute("download_url")},null,8,["href"])):g("",!0)])])),p("div",vt,[yt,p("a",{href:r.displayedCapture.validated_url},h(r.displayedCapture.requested_url),9,["href"])]),r.displayedCapture.label?(d(),u("div",wt,[kt,p("p",null,h(r.displayedCapture.label),1)])):g("",!0),r.displayedCapture.message?(d(),u("div",xt,[Ct,p("div",At,[p("div",Tt,h(r.displayedCapture.message),1)])])):g("",!0),r.getArchiveAttribute("screenshot_url")&&!r.getArchiveAttribute("download_url")?(d(),u("div",Lt,[St,p("img",{class:"screenshot",src:r.getArchiveAttribute("screenshot_url")},null,8,["src"])])):g("",!0),r.getArchiveAttribute("download_url")?(d(),u("div",Pt,[Dt,p("div",Ut,[p("replay-web-page",{source:r.getArchiveAttribute("download_url"),url:r.displayedCapture.validated_url,replaybase:"/replay/",class:"replay contextItem"},null,8,["source","url"])])])):g("",!0),r.size?(d(),u("div",It,[Ft,p("p",null,h(r.size)+"MB",1)])):g("",!0),r.getArchiveAttribute("title")?(d(),u("div",Et,[Wt,p("p",null,h(r.getArchiveAttribute("title")),1)])):g("",!0),r.getArchiveAttribute("description")?(d(),u("div",zt,[jt,p("p",null,h(r.getArchiveAttribute("description")),1)])):g("",!0),r.getArchiveAttribute("target_url_content_type")?(d(),u("div",Ht,[Rt,p("p",null,h(r.getArchiveAttribute("target_url_content_type")),1)])):g("",!0),r.getArchiveAttribute("summary")?(d(),u("div",qt,[Mt,p("pre",null,h(r.getArchiveAttribute("summary")),1)])):g("",!0)])):g("",!0)};const{mapActions:Ot}=i("captures");var $t={components:{CaptureDetail:ut},props:["capture"],data:()=>({displayDetails:!1}),computed:{statusOrDefault(){return he(this.capture.status||"pending")},isProcessing(){return this.statusOrDefault in fe},succeeded(){return this.statusOrDefault in ke},get_title(){var e;let t;switch(this.statusOrDefault){case"Invalid":t="Invalid URL";break;case"InProgress":t="Capture In Progress";break;case"Failed":t="Capture Failed";break;case"Completed":t=(null==(e=this.capture)?void 0:e.archive.title)||"Capture Completed";break;default:t="Capture Pending"}return t},url(){return this.capture.validated_url||this.capture.requested_url},downloadUrl(){return this.capture.archive?this.capture.archive.download_url:null},expiresAt(){return this.capture.archive?new Date(this.capture.archive.download_expiration_timestamp):null},isMobile(){return this.$store.getters.isMobile}},watch:{"$store.getters.displayedCapture":function(e){e&&e.id===this.capture.id||(this.displayDetails=!1)}},methods:r(r({},Ot(["read"])),{toggleCaptureDetails(e){this.displayDetails=!this.displayDetails,this.displayDetails?Le.commit("setDisplayedCapture",e):Le.commit("setDisplayedCapture",void 0)},getDate:e=>me(e),shortenUrl:e=>e.length<=100?e:e.slice(0,100)+"..."})};const Bt={class:"content"},Vt=p("div",{class:"favicon","aria-hidden":"true"},"ðŸ”—",-1),Zt={class:"h6 capture-title"},Nt={class:"btn-group spinner"},Kt={key:0,class:"status-icon spinner spinner-border spinner-border-sm","aria-hidden":"true"},Gt={key:1,class:"btn bi bi-download download-button placeholder"},Yt={key:1,class:"capture-url"},Xt={class:"secondary-text recorded-date"},Jt=f("Â  "),Qt={key:0,class:"warning-text expired-date"},ea={key:1,class:"expired-date"};$t.render=function(e,t,a,n,s,r){const i=c("capture-detail");return d(),u("li",{class:[{active:r.isProcessing||r.downloadUrl,"details-shown":e.displayDetails},"capture-list-item"]},[p("div",Bt,[Vt,p("h3",Zt,h(r.get_title),1),p("div",Nt,[r.isProcessing?(d(),u("span",Kt)):(d(),u(m,{key:1},[r.downloadUrl?(d(),u("a",{key:0,class:"btn bi bi-download download-button",href:r.downloadUrl},null,8,["href"])):(d(),u("span",Gt)),p("button",{class:["btn bi bi-chevron-right replay-toggle",{active:e.displayDetails}],onClick:t[1]||(t[1]=e=>r.toggleCaptureDetails(a.capture))},null,2)],64))]),"Invalid"===r.statusOrDefault?(d(),u("span",{key:0,class:"capture-url",textContent:h(r.shortenUrl(r.url))},null,8,["textContent"])):(d(),u("span",Yt,[p("a",{href:r.url,textContent:h(r.shortenUrl(r.url))},null,8,["href","textContent"])])),p("span",Xt,"Submitted "+h(r.getDate(a.capture.created_at)),1),Jt,r.isProcessing?g("",!0):(d(),u(m,{key:2},[r.downloadUrl?(d(),u("span",Qt,"Expires "+h(r.getDate(r.expiresAt)),1)):r.succeeded?(d(),u("span",ea,"Expired "+h(r.getDate(r.expiresAt)),1)):g("",!0)],64)),r.isMobile&&e.displayDetails&&a.capture.id===e.$store.getters.displayedCapture.id?(d(),u(i,{key:3})):g("",!0)])],2)};const{mapGetters:ta,mapActions:aa,mapState:na}=i("captures");var sa={poller:null,components:{CaptureListItem:$t},data:()=>({loading:!0,sortBy:"created_at",sortDesc:!0,headings:{status:"Status",url:"URL",label:"Label",created_at:"Created At"},scrollable:!1,scrolled:!1}),computed:r(r(r({},ta({processing:"processing",captures:"sortedBy"})),na({apiContext:"apiContext"})),{apiParams(){return{ordering:(this.sortDesc?"-":"")+this.sortBy}}}),methods:r(r({},aa(["list","pageForward","batchRead"])),{pollForProcessingChanges(){this.$options.poller=setInterval((()=>{this.batchRead(this.processing)}),3e3)},clearProcessingPoll(){clearInterval(this.$options.poller)},clearLazyLoadListeners(){this.$refs.captureList.removeEventListener("scroll",this.handleLazyLoad),window.removeEventListener("scroll",this.handleLazyLoad)},handleLazyLoad(e){let t=this.$refs.captureList,a=this.$store.getters.isSmallestScreen&&t.getBoundingClientRect().bottom<window.innerHeight,n=!this.$store.getters.isSmallestScreen&&t.scrollHeight-Math.abs(t.scrollTop)===t.clientHeight;(a||n)&&(this.clearLazyLoadListeners(),this.loading=!0,this.pageForward().then((()=>this.loading=!1)))},checkIsScrollable(){this.$nextTick((function(){!this.$store.getters.isSmallestScreen&&this.$refs.captureList.scrollHeight>=.8*this.$store.getters.viewportHeight?this.scrollable=!0:this.scrollable=!1}))},applyScrollStyles(e){e.target.scrollTop>0?this.scrolled=!0:this.scrolled=!1},changeSort(e){this.sortBy==e?this.sortDesc=!this.sortDesc:(this.sortBy=e,this.sortDesc=!0)}}),watch:{apiParams:{deep:!0,handler(){this.list(this.apiParams)}},apiContext:{deep:!0,handler(e,t){e.next?(this.$refs.captureList.addEventListener("scroll",this.handleLazyLoad),window.addEventListener("scroll",this.handleLazyLoad)):this.clearLazyLoadListeners()}},processing(e,t){this.$options.poller?e.length||this.clearProcessingPoll():e.length&&this.pollForProcessingChanges()}},created(){this.list().then((()=>this.loading=!1))},mounted(){this.$nextTick((function(){window.addEventListener("resize",this.checkIsScrollable)}))},updated(){this.$nextTick((function(){this.checkIsScrollable()}))},beforeUnmount(){this.clearProcessingPoll(),this.clearLazyLoadListeners(),window.removeEventListener("resize",this.checkIsScrollable)}};const ra=b();l("data-v-d4920d5a");const ia={class:"captures-list"},la=p("header",{class:"captures-header"},[p("h2",{class:"list-title"},"Capture history")],-1),oa={key:0,class:"capture-list-loading"};o();const ca=ra(((e,t,a,n,s,r)=>{const i=c("CaptureListItem");return d(),u("div",ia,[la,p("ul",{ref:"captureList",class:{scrollable:e.scrollable,scrolled:e.scrolled},onScroll:t[1]||(t[1]=(...e)=>r.applyScrollStyles&&r.applyScrollStyles(...e))},[(d(!0),u(m,null,P(e.captures(e.sortBy,e.sortDesc),(e=>(d(),u(i,{key:e.id,capture:e},null,8,["capture"])))),128)),e.loading?(d(),u("li",oa,"Loading...")):g("",!0)],34)])}));sa.render=ca,sa.__scopeId="data-v-d4920d5a";const{mapState:da}=i("globals");var ua={components:{CaptureForm:Pe,CaptureList:sa,CaptureDetail:ut},computed:r({isMobile(){return this.$store.getters.isMobile},displayedCapture(){return this.$store.getters.displayedCapture}},da({rwp_base_url:"rwp_base_url"})),mounted(){this.$store.commit("setWindowWidth"),this.$store.commit("setViewportHeight"),this.$nextTick((()=>{window.addEventListener("resize",function(e,t=500){let a;return()=>{let n=arguments;clearTimeout(a),a=setTimeout((()=>{e.apply(this,n)}),t)}}((()=>{this.$store.commit("setWindowWidth"),this.$store.commit("setViewportHeight")}),250))}));const e=document.createElement("script");e.setAttribute("src",this.rwp_base_url+"/ui.js"),document.head.appendChild(e)}};ua.render=function(e,t,a,n,s,r){const i=c("CaptureForm"),l=c("CaptureList"),o=c("capture-detail");return d(),u("div",{class:["capture-dashboard container",{"capture-detail":!e.$store.getters.isMobile&&r.displayedCapture}]},[p(i),p(l),r.isMobile?g("",!0):(d(),u(o,{key:0}))],2)};const{mapState:pa}=i("user");var ha={components:{TheDashboard:ua},computed:pa(["is_authenticated"]),beforeMount(){this.is_authenticated||this.$router.push({name:"login"})}};const ma={class:"container-full root-page-container"};ha.render=function(e,t,a,n,s,r){const i=c("TheDashboard");return d(),u("div",ma,[e.is_authenticated?(d(),u(i,{key:0})):g("",!0)])};var ga={props:{head:{type:String},subhead:{type:String},center:{type:Boolean,default:!0}}};const _a=b()(((e,t,a,n,s,r)=>(d(),u(m,null,[p("h1",{class:[{"text-center":a.center},"main-header"]},h(a.head),3),a.subhead?(d(),u("p",{key:0,class:[{"text-center":a.center},"main-subheader"]},h(a.subhead),3)):g("",!0)],64))));ga.render=_a,ga.__scopeId="data-v-aac6d7cc";const{mapState:ba}=i("globals"),{mapState:fa}=i("user");var va={components:{TheMainHeader:ga},computed:r(r(r({},ba(["rwp_base_url"])),fa(["auth_token"])),{base_url:()=>window.location.origin,auth_token_key(){var e;return(null==(e=this.auth_token)?void 0:e.key)||"your-api-key"}}),mounted(){const e=document.createElement("script");e.setAttribute("src",this.rwp_base_url+"/ui.js"),document.head.appendChild(e)}};const ya={class:"container-full docs-page-container"},wa={class:"docs container"},ka=y('<ul class="table-of-contents"><li><a href="#capturing-urls">Capturing URLs</a><ul><li><a href="#capturing-ui">Using the Web Interface</a></li><li><a href="#capturing-api">Using the API</a><ul><li><a href="#capturing-auth">Authorization</a></li><li><a href="#capturing-endpoints">Endpoints</a></li></ul></li><li><a href="#capturing-advanced-features">Advanced Features</a><ul><li><a href="#webhook-notifications">Webhooks</a></li><li><a href="#zapier-integration">Zapier Integration</a></li></ul></li><li><a href="#capturing-under-development">Features in Development</a><ul><li>Archive Hashes</li></ul></li></ul></li><li><a href="#viewing-captured-urls">Viewing Captured URLs</a><ul><li><a href="#embed-instructions">How to Embed</a></li><li><a href="#embed-examples">Examples</a><ul><li>Glitch</li></ul></li></ul></li></ul>',1),xa={class:"content"},Ca=p("p",{class:"lead"},[f("The Perma.cc capture system is built on "),p("a",{href:"https://github.com/harvard-lil/scoop"},"Scoop"),f(" and uses an automated browser to produce high-fidelity web archives.")],-1),Aa=p("p",null,[f("A compressed "),p("a",{href:"https://github.com/webrecorder/wacz-format"},"web archive file"),f(' (WACZ) is created for each submitted URL, and each archive can be downloaded, embedded in a web page and displayed ("replayed") by any '),p("a",{href:"https://caniuse.com/serviceworkers"},"modern browser"),f(".")],-1),Ta=p("h2",{id:"capturing-urls"},"Capturing URLs",-1),La=p("h3",{id:"capturing-ui"},"Using the Web Interface",-1),Sa=f("After logging in, simply "),Pa=f("enter the URLs"),Da=f(' you\'d like to preserve and click "Create." A capture job will be launched for each submitted URL. '),Ua=p("p",null,"A list of all your active capture jobs will appear next to the form. When each job is finished, you can click the chevron to see a preview of the capture and download the web archive file. ",-1),Ia=p("p",null,[p("img",{style:{"max-width":"100%"},src:"/static/vite/dashboard-screenshot-expand.589bdefb.png",alt:"Screenshot of the dashboard. The 'create a new archive' form is next to a list of 2 capture jobs, with their 'expand details' button circled."})],-1),Fa=p("p",null,[p("img",{style:{"max-width":"100%"},src:"/static/vite/dashboard-screenshot-download.4710f6aa.png",alt:"Screenshot of the dashboard with a capture job's details expanded. The 'downlad' button is circled."})],-1),Ea=p("p",null,"Web archive files are retained for 4 hours and then are automatically deleted. Deleted archives cannot be recovered from the service. Metadata, however, is retained indefinitely.",-1),Wa=p("h3",{id:"capturing-api"},"Using the API",-1),za={key:0},ja=f("Your API Key is "),Ha=f("."),Ra=p("h4",{id:"capturing-auth"},"Authorization ",-1),qa=f("All registered users receive an "),Ma=f("API key"),Oa=f(". Every request to the API must be authenticated by providing that key as part of the "),$a=p("code",null,"Authorization",-1),Ba=f(" header: "),Va=p("h4",{id:"capturing-endpoints"},"Endpoints",-1),Za=f("You can create archives programmatically by sending an HTTP "),Na=p("code",null,"POST",-1),Ka=f(" to "),Ga=f("."),Ya=p("p",null,[f("A minimal capture request using "),p("code",null,"curl"),f(":")],-1),Xa=p("pre",null,[p("code",null,'\ncurl -X POST http://localhost:8000/captures/ \\\n     -H "Content-Type: application/json" \\\n     -H "Authorization: Token c27a765c26bd8aeee8859ca55e7d06ec2a4852a8" \\\n     --data \'{"requested_url":"example.com"}\'\n        ')],-1),Ja=p("p",null,[f("Optionally, you may configure a number of advanced capture options, and may specify a "),p("code",null,"label"),f(" to associate with the capture for your convenience (for instance, labeling a group of related captures). If you are subscribed to "),p("a",{href:"#webhook-notifications"},"webhook notifications"),f(", you may also optionally specify "),p("code",null,"webhook_data"),f(" for your convenience (a string you would like included, verbatim, in the webhook notification response).")],-1),Qa=p("p",null,"You may submit capture requests singly or in batches.",-1),en=p("p",null,"Here's a request to archive a small batch of two URLs. The first toggles all currently available advanced options to their non-default values.",-1),tn=p("p",null,[f("The response, on success, will be a JSON dictionary including an ID for each request, the status of the request ("),p("code",null,"pending"),f(", "),p("code",null,"in_progress"),f(", "),p("code",null,"completed"),f(", "),p("code",null,"failed"),f(", or "),p("code",null,"invalid"),f("), and all the configuration options. Example: ")],-1),an=p("pre",null,[p("code",null,'\n{\n  "id": 16,\n  "requested_url": "example.com",\n  "validated_url": null,\n  "human": false,\n  "include_raw_exchanges": false,\n  "include_screenshot": true,\n  "include_pdf_snapshot": false,\n  "include_dom_snapshot": false,\n  "include_videos_as_attachment": true,\n  "include_certificates_as_attachment": true,\n  "run_site_specific_behaviors": true,\n  "headless": true,\n  "label": null,\n  "webhook_data": null,\n  "status": "pending",\n  "message": null,\n  "queue_position": 1,\n  "step_count": 0,\n  "step_description": null,\n  "created_at": "2023-05-10T16:00:22.134813Z",\n  "updated_at": "2023-05-10T16:00:22.134831Z",\n  "capture_start_time": null,\n  "capture_end_time": null,\n  "archive": null\n}\n        ')],-1),nn=f("You can query "),sn=f(" to see all the capture jobs you have in the system:"),rn=p("p",null,"Sample Response:",-1),ln=p("pre",null,[p("code",null,'\n[\n  {\n    "id": 15,\n    "requested_url": "example.com",\n    "validated_url": "http://example.com",\n    "human": false,\n    "include_raw_exchanges": false,\n    "include_screenshot": true,\n    "include_pdf_snapshot": false,\n    "include_dom_snapshot": false,\n    "include_videos_as_attachment": true,\n    "include_certificates_as_attachment": true,\n    "run_site_specific_behaviors": true,\n    "headless": true,\n    "label": "",\n    "webhook_data": null,\n    "status": "completed",\n    "message": null,\n    "queue_position": 0,\n    "step_count": 20,\n    "step_description": "Saving screenshot.",\n    "created_at": "2023-05-10T16:00:01.904961Z",\n    "updated_at": "2023-05-10T16:00:06.650394Z",\n    "capture_start_time": "2023-05-10T16:00:01.989230Z",\n    "capture_end_time": "2023-05-10T16:00:06.650624Z",\n    "archive": {\n      "id": 14,\n      "hash": "56052c28e76ac4bebd4551f4d834e7e8cf9683dc1a41a30a901500152b372fcf",\n      "hash_algorithm": "sha256",\n      "size": 34036,\n      "download_url": "http://localhost:9000/perma-capture/archives/job-15-example-com.wacz?AWSAccessKeyId=accesskey&Signature=BruX09kwS8naC5xXl9xtTMGLnoE%3D&Expires=1683748806",\n      "download_expiration_timestamp": "2023-05-10T20:00:06Z",\n      "created_at": "2023-05-10T16:00:06.559135Z",\n      "updated_at": "2023-05-10T16:00:06.559144Z",\n      "partial_capture": false,\n      "target_url_content_type": "text/html; charset=UTF-8",\n      "entrypoints": {\n        "web_capture": "http://example.com/",\n        "screenshot": "file:///screenshot.png",\n        "provenance_summary": "file:///provenance-summary.html"\n      },\n      "noarchive_urls": [],\n      "title": "Example Domain",\n      "description": null,\n      "wacz_version": "1.1.1",\n      "capture_software": "Scoop @ Harvard Library Innovation Lab: 0.3.1",\n      "screenshot_url": "http://localhost:9000/perma-capture/screenshots/archive_14/screenshot.png?AWSAccessKeyId=accesskey&Signature=Nh6mIRusqLHt9MWrVJPtH78dYDM%3D&Expires=1683738141"\n    }\n  },\n  {\n  "id": 16,\n  "requested_url": "example.com",\n  "validated_url": null,\n  "human": false,\n  "include_raw_exchanges": false,\n  "include_screenshot": true,\n  "include_pdf_snapshot": false,\n  "include_dom_snapshot": false,\n  "include_videos_as_attachment": true,\n  "include_certificates_as_attachment": true,\n  "run_site_specific_behaviors": true,\n  "headless": true,\n  "label": null,\n  "webhook_data": null,\n  "status": "pending",\n  "message": null,\n  "queue_position": 1,\n  "step_count": 0,\n  "step_description": null,\n  "created_at": "2023-05-10T16:00:22.134813Z",\n  "updated_at": "2023-05-10T16:00:22.134831Z",\n  "capture_start_time": null,\n  "capture_end_time": null,\n  "archive": null\n  }\n]\n        ')],-1),on=p("p",null,[f("A job that is "),p("code",null,"in_progress"),f(" should be monitored until it is "),p("code",null,"completed"),f(". (Or, if you'd like to be notified when a job is complete, check out "),p("a",{href:"#webhook-notifications"},"webhook notifications"),f(".) A "),p("code",null,"failed"),f(" job indicates a permanent failure: you may wish to retry.")],-1),cn=p("p",null,[f("A job that is "),p("code",null,"completed"),f(" will include information on the associated web archive, including its "),p("code",null,"download_url"),f(" and "),p("code",null,"download_expiration_timestamp"),f(".")],-1),dn=p("p",null,"The download URL is valid for 4 hours after the job is completed, after which the web archive files is automatically deleted. Deleted archives cannot be recovered from the service. Metadata, however, is retained indefinitely.",-1),un=p("h3",{id:"capturing-advanced-features"},"Advanced Features",-1),pn=p("h4",{id:"webhook-notifications"},"Webhook Notifications",-1),hn=p("p",null,[f("We can notify you when your capture jobs are complete by sending an HTTP "),p("code",null,"POST"),f("to a callback URL you specify.")],-1),mn=f("To subscribe to the "),gn=p("code",null,"ARCHIVE_CREATED",-1),_n=f(" event, "),bn=p("code",null,"POST",-1),fn=f(" your callback URL to "),vn={href:"/webhooks/"},yn=f("."),wn=p("p",null,[f("We'll send back a subscription "),p("code",null,"id"),f(", as well as a "),p("code",null,"signing_key"),f(" and "),p("code",null,"signing_key_algorithm"),f(" that you can optionally use to verify that any "),p("code",null,"POST"),f(" received by your callback URL is really from us.")],-1),kn=p("pre",null,[p("code",null,'\n{\n  "id": 2,\n  "created_at": "2023-05-10T16:32:49.289925Z",\n  "updated_at": "2023-05-10T16:32:49.289944Z",\n  "event_type": "ARCHIVE_CREATED",\n  "callback_url": "https://webhookservice.com?hookid=1234",\n  "signing_key": "14135949d61787acc592defd569d3686c8c61ca9d1b8f7e0e51d318a1391037553a8a3b3c6073d7f86679ec76e08144cb85f7193491e421a11667c7abc8a8224",\n  "signing_key_algorithm": "sha256"\n}\n        ')],-1),xn=p("p",null,"You can subscribe as many times as you like, if you'd like multiple callback URLs to be notified.",-1),Cn=p("p",null,[f("When an archive you request is complete, we'll make a "),p("code",null,"POST"),f(" to your callback like the following: ")],-1),An=p("pre",null,[p("code",null,'\n{\n  "webhook": {\n    "id": 2,\n    "event_type": "ARCHIVE_CREATED"\n  },\n  "capture_job": {\n    "id": 18,\n    "requested_url": "example.com",\n    "validated_url": "http://example.com",\n    "human": false,\n    "include_raw_exchanges": false,\n    "include_screenshot": true,\n    "include_pdf_snapshot": false,\n    "include_dom_snapshot": false,\n    "include_videos_as_attachment": true,\n    "include_certificates_as_attachment": true,\n    "run_site_specific_behaviors": true,\n    "headless": true,\n    "label": "",\n    "webhook_data": null,\n    "status": "in_progress",\n    "message": null,\n    "queue_position": 0,\n    "step_count": 19,\n    "step_description": "Saving summary metadata.",\n    "created_at": "2023-05-10T16:37:05.968035Z",\n    "updated_at": "2023-05-10T16:37:10.141362Z",\n    "capture_start_time": "2023-05-10T16:37:06.036673Z",\n    "capture_end_time": null,\n    "archive": {\n      "id": 17,\n      "hash": "49d09036e1c2d884b8b2efc993ced21288086c4e7a8a989e72818a783ac72dd6",\n      "hash_algorithm": "sha256",\n      "size": 34040,\n      "download_url": "http://localhost:9000/perma-capture/archives/job-18-example-com.wacz?AWSAccessKeyId=accesskey&Signature=np4mDrQsebLgdK5I1zXT26YBQVQ%3D&Expires=1683751030",\n      "download_expiration_timestamp": "2023-05-10T20:37:10Z",\n      "created_at": "2023-05-10T16:37:10.143777Z",\n      "updated_at": "2023-05-10T16:37:10.143786Z",\n      "partial_capture": false,\n      "target_url_content_type": "text/html; charset=UTF-8",\n      "entrypoints": {\n        "web_capture": "http://example.com/",\n        "screenshot": "file:///screenshot.png",\n        "provenance_summary": "file:///provenance-summary.html"\n      },\n      "noarchive_urls": [],\n      "title": "Example Domain",\n      "description": null,\n      "wacz_version": "1.1.1",\n      "capture_software": "Scoop @ Harvard Library Innovation Lab: 0.3.1",\n      "screenshot_url": null\n    }\n  }\n}\n        ')],-1),Tn=p("p",null,[f("We will include the signature in the "),p("code",null,"x-hook-signature"),f(" header.")],-1),Ln=p("p",null,"If you want to verify the signature before acting, here's how to do it in Python:",-1),Sn=p("pre",null,[p("code",null,"\nimport hmac\nimport urllib\ndef is_valid_signature(signature, data, signing_key, signing_key_algorithm):\n  return hmac.compare_digest(\n    signature,\n    hmac.new(\n    bytes(signing_key, 'utf-8'),\n    bytes(urllib.parse.urlencode(data, doseq=True), 'utf-8'),\n    signing_key_algorithm\n  ).hexdigest()\n)\n        ")],-1),Pn=p("p",null,"...and JavaScript:",-1),Dn=p("pre",null,[p("code",null,"\nconst crypto = require('crypto');\nconst querystring = require('querystring');\n\nfunction isValidSignature(signature, data, signingKey, signingKeyAlgorithm){\n  const postedSignature = Buffer.from(signature, 'utf-8');\n  const generatedSignature = Buffer.from(\n    crypto.createHmac(signingKeyAlgorithm, signingKey).update(querystring.stringify(data)).digest('hex'),\n    'utf-8'\n  );\n  try {\n    return crypto.timingSafeEqual(postedSignature, generatedSignature);\n  } catch (e) {\n    return false;\n  }\n}\n        ")],-1),Un=p("p",null,"If you no longer wish to receive notifications, you can delete your subscription:",-1),In=p("p",null,"Sample response:",-1),Fn=p("pre",null,[p("code",null,"\nHTTP/1.1 204 No Content\nDate: Wed, 10 May 2023 16:43:36 GMT\nContent-Length: 0\n        ")],-1),En=p("h4",{id:"zapier-integration"},"Zapier Integration",-1),Wn=p("p",null,[p("a",{href:"https://zapier.com"},"Zapier"),f(" users can integrate the Perma.cc capture service in their workflows. ")],-1),zn=p("p",null,[f("For example, using this Zap, you can "),p("a",{href:"https://zapier.com/shared/3ee9336c0d9734d9fe6cc86e672b530f8336e93b"},"archive a URL straight from Slack"),f(", and this Zap will follow up, posting a "),p("a",{href:"https://zapier.com/app/editor/108033832/nodes/108033832"},"link to the completed archive as a reply"),f(", when it's finished.")],-1),jn=p("p",null,[p("img",{style:{"max-width":"100%"},src:"/static/vite/slack-screenshot.46ab25e6.png",alt:"Screenshot of Slack, showing a capture request and a threaded reply with a link to the archive."})],-1),Hn=p("p",null,[f("This Zap, on the other hand, will post to a pre-configured Slack channel of your choice whenever "),p("a",{href:"https://zapier.com/shared/e1ccf1faa9b236b2317b85b46f0a643e8259aa77"},"an archive created by your account is ready to be downloaded"),f(".")],-1),Rn=p("p",null,"Let us know if you are interested in a Zapier integration, and we'll help you get started!",-1),qn=p("p",null,[f("Note: Zapier does not support "),p("a",{href:"http://resthooks.org/docs/security/"},"signature validation"),f(", instead relying on the privacy of subscription URLs for security. If you need to further verify the authenticity of data triggering your workflows, we recommend working with our webhooks directly.")],-1),Mn=p("h3",{id:"capturing-under-development"},"Features in Development",-1),On=p("h4",{id:"archive-hashes"},"Archive Hashes",-1),$n=p("p",null,[f("We maintain a "),p("code",null,"sha-256"),f(" hash of every web archive file produced by the service.")],-1),Bn=p("p",null,[f("We selected "),p("code",null,"sha256"),f(", despite its known limitations, because we wanted the algorithm to be "),p("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest"},"supported in JavaScript"),f(", and we weren't sure it was reasonable to expect users attempting to verify file hashes to manually calculate "),p("code",null,"sha512/256"),f(".")],-1),Vn=p("p",null,"Let us know if that sounds correct to you!",-1),Zn=p("hr",null,null,-1),Nn=p("h2",{id:"viewing-captured-urls"},"Viewing Captured URLs",-1),Kn=p("p",null,[f("The downloadable WACZ files can be played back at "),p("a",{href:"https://replayweb.page"},"ReplayWeb.page"),f(" and embedded in your site using using "),p("a",{href:"https://github.com/harvard-lil/wacz-exhibitor"},"wacz-exhibitor"),f(", an "),p("a",{href:"https://lil.law.harvard.edu/blog/2022/09/15/opportunities-and-challenges-of-client-side-playback/"},"efficient and secure wrapper"),f(" of ReplayWeb.page's embed system.")],-1),Gn=p("h3",{id:"embed-examples"},"Example",-1),Yn=p("p",null,[f("The following archive was created using this system: "),p("a",{href:"https://warcembed-demo.s3.amazonaws.com/twitter.com-2020-09-03.wacz"},"https://warcembed-demo.s3.amazonaws.com/twitter.com-2020-09-03.wacz")],-1),Xn=p("p",null,"We'll embed a replay of the archive directly in this page:",-1),Jn=p("replay-web-page",{style:{display:"block",height:"600px","margin-bottom":"1em"},source:"https://warcembed-demo.s3.amazonaws.com/twitter.com-2020-09-03.wacz",url:"https://twitter.com/dog_rates/status/1298052245209006086?s=20",replaybase:"/replay/"},null,-1),Qn=p("p",null,[f("To see more examples of embedded archives, visit the "),p("a",{href:"https://warcembed-demo.lil.tools/"},"WACZ-Exhibitor Museum")],-1);va.render=function(e,t,a,n,s,r){const i=c("TheMainHeader"),l=c("router-link");return d(),u("div",ya,[p("div",wa,[ka,p("div",xa,[p(i,{head:"User Guide",center:!1}),Ca,Aa,Ta,La,p("p",null,[Sa,p(l,{to:{name:"root"}},{default:v((()=>[Pa])),_:1}),Da]),Ua,Ia,Fa,Ea,Wa,e.auth_token?(d(),u("p",za,[p("em",null,[ja,p("code",null,h(e.auth_token.key),1),Ha])])):g("",!0),Ra,p("p",null,[qa,p(l,{to:{name:"account"}},{default:v((()=>[Ma])),_:1}),Oa,$a,Ba]),p("pre",null,[p("code",null,'curl -H "Authorization: Token '+h(r.auth_token_key)+'" '+h(r.base_url)+"...",1)]),Va,p("p",null,[Za,Na,Ka,p("code",null,h(r.base_url+"/captures/"),1),Ga]),Ya,Xa,Ja,Qa,en,p("pre",null,[p("code",null,"\ncurl -X POST "+h(r.base_url+"/captures/")+' \\\n-H "Content-Type: application/json" \\\n-H "Authorization: Token '+h(r.auth_token_key)+'" \\\n--data-binary @- << EOF\n[\n    {\n        "requested_url":"example.com",\n        "label": "my-batch",\n        "include_raw_exchanges": true,\n        "include_screenshot": false,\n        "include_pdf_snapshot": true,\n        "include_dom_snapshot": true,\n        "include_videos_as_attachment": false,\n        "include_certificates_as_attachment": false,\n        "run_site_specific_behaviors": false\n    }, {\n        "requested_url":"https://twitter.com/permacc",\n        "label": "my-batch",\n        "webhook_data": "foo=bam&boo=bap"\n    }\n]\nEOF\n        ',1)]),tn,an,p("p",null,[nn,p("code",null,h(r.base_url+"/captures/"),1),sn]),p("pre",null,[p("code",null,'curl -H "Authorization: Token '+h(r.auth_token_key)+'" '+h(r.base_url+"/captures/"),1)]),rn,ln,on,cn,dn,un,pn,hn,p("p",null,[mn,gn,_n,bn,fn,p("a",vn,h(r.base_url+"/webhooks/"),1),yn]),p("pre",null,[p("code",null,"\ncurl -X POST "+h(r.base_url+"/webhooks/")+' \\\n     -H "Content-Type: application/json" \\\n     -H "Authorization: Token '+h(r.auth_token_key)+'" \\\n     --data \'{"callback_url": "https://webhookservice.com?hookid=1234", "event_type": "ARCHIVE_CREATED"}\'\n        ',1)]),wn,kn,xn,Cn,An,Tn,Ln,Sn,Pn,Dn,Un,p("pre",null,[p("code",null,'curl -i -X DELETE -H "Authorization: Token '+h(r.auth_token_key)+'" '+h(r.base_url+"/webhooks/2"),1)]),In,Fn,En,Wn,zn,jn,Hn,Rn,qn,Mn,On,$n,Bn,Vn,Zn,Nn,Kn,Gn,Yn,Xn,Jn,Qn])])])};const{mapActions:es}=i("user");var ts={props:{fields:Array,submitText:{type:String,default:"Submit"},action:Function,title:String,headingLevel:{type:Number,default:1}},data:()=>({processing:!1,displayValidations:!1,errors:{}}),computed:{fieldsWithDefaults(){return this.fields.map((e=>r({label:e.name.split("_").map(((e,t)=>t?e:e.charAt(0).toUpperCase()+e.slice(1))).join(" "),id:e.name+Date.now(),type:"text",readonly:!1,disabled:!1,required:!0},e)))},errorCount(){return Object.keys(this.errors).length}},watch:{errorCount(e){e&&this.displayValidations&&this.$nextTick((()=>this.$refs.errorsHeader.focus()))}},methods:r(r({},es(["changePassword"])),{getFieldByName(e){return this.fieldsWithDefaults.find((t=>t.name==e))},checkValidity(e){e.target.checkValidity()&&delete this.errors[e.target.name]},onInvalid(e){this.errors[e.target.name]=[{message:e.target.validationMessage}]},collectFrontendErrors(){this.errors={},this.$el.querySelectorAll(":invalid").forEach((e=>this.errors[e.name]=[{message:e.validationMessage}]))},submit(e){this.collectFrontendErrors(),this.displayValidations=!0,0==this.errorCount&&(this.processing=!0,this.action(new FormData(e.target)).then((()=>this.displayValidations=!1)).catch((e=>this.errors=e)).then((()=>this.processing=!1)))}})};const as={key:1,ref:"errorsHeader",tabindex:"-1",class:"invalid-field-summary alert alert-danger"},ns=f(" Please correct the following "),ss=f("error"),rs={key:1},is=f(": "),ls={class:"invalid-field-list"},os=f(": "),cs={class:"form-floating mb-3"},ds={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};ts.render=function(e,t,a,n,s,r){return d(),u("form",{class:"base-form",onSubmit:t[3]||(t[3]=_(((...e)=>r.submit&&r.submit(...e)),["prevent"])),novalidate:""},[a.title?(d(),u("div",{key:0,role:"heading","aria-level":a.headingLevel,class:["form-heading mb-1","h"+a.headingLevel]},h(a.title),11,["aria-level"])):g("",!0),e.displayValidations&&r.errorCount?(d(),u("div",as,[ns,1==r.errorCount?(d(),u(m,{key:0},[ss],64)):(d(),u("strong",rs,h(r.errorCount)+" errors",1)),is,p("ul",ls,[(d(!0),u(m,null,P(e.errors,((e,t)=>(d(),u("li",null,["__all__"!=t?(d(),u(m,{key:0},[p("a",{class:"alert-link",href:"#"+r.getFieldByName(t).id},h(r.getFieldByName(t).label),9,["href"]),os],64)):g("",!0),f(" "+h(e.map((({message:e})=>e)).join(", ")),1)])))),256))])],512)):g("",!0),(d(!0),u(m,null,P(r.fieldsWithDefaults,(a=>(d(),u("div",cs,[A(p("input",{"onUpdate:modelValue":e=>a.value=e,onBlur:t[1]||(t[1]=(...e)=>r.checkValidity&&r.checkValidity(...e)),onInvalid:t[2]||(t[2]=(...e)=>r.onInvalid&&r.onInvalid(...e)),placeholder:a.label,name:a.name,id:a.id,type:a.type,class:["form-control",{"is-invalid":e.displayValidations&&e.errors[a.name],"form-control-plaintext":a.readonly}],required:a.required,disabled:!0===a.disabled||e.processing,readonly:a.readonly,"aria-invalid":!!e.errors[a.name],"aria-describedby":(e.errors[a.name]||[]).map(((e,t)=>a.id+"InvalidFeedback"+t))},null,42,["onUpdate:modelValue","placeholder","name","id","type","required","disabled","readonly","aria-invalid","aria-describedby"]),[[D,a.value]]),p("label",{for:a.id,class:"form-label"},h(a.label),9,["for"]),(d(!0),u(m,null,P(e.errors[a.name],((e,t)=>(d(),u("div",{id:a.id+"InvalidFeedback"+t,class:"invalid-feedback"},h(e.message),9,["id"])))),256))])))),256)),p("button",{type:"submit",class:"btn btn-primary mt-1",disabled:e.processing},[e.processing?(d(),u("span",ds)):g("",!0),f(" "+h(a.submitText),1)],8,["disabled"])],32)};const us={name:"WelcomeMessage"},ps=b();l("data-v-6355e12a");const hs={class:"message"},ms=p("h1",{class:"mb-4"},[f(" Websites change."),p("br"),p("span",{class:"blue-text"},"Perma Captures"),f(" don't. ")],-1),gs=p("span",{class:"h5 subtitle mb-2"},"Perma Captures help scholars, newsrooms, researchers, and others create permanent records of the web.",-1),_s=p("span",{class:"h5 subtitle d-none d-sm-none d-md-block mb-4"},"Simply create a capture and download it for your records.",-1),bs=p("img",{class:"d-none d-sm-none d-md-block",src:"/static/vite/welcome-graphic.bc1da09f.svg",alt:"Graphic showing that while websites change, Perma Captures don't."},null,-1);o();const fs=ps(((e,t,a,n,s,r)=>(d(),u("div",hs,[ms,gs,_s,bs]))));us.render=fs,us.__scopeId="data-v-6355e12a";const{mapState:vs}=i("globals"),{mapActions:ys}=i("user");var ws={components:{BaseForm:ts,WelcomeMessage:us},computed:vs(["app_name","contact_email","allow_signups"]),data:()=>({fields:[{name:"first_name",label:"First name"},{name:"last_name",label:"Last name"},{name:"email",label:"Email"}]}),methods:r(r({},ys(["signup"])),{signUp(e){return this.signup(e).then((()=>window.location="/"))}})};const ks=b();l("data-v-cba6fa52");const xs={class:"container-full two-col login-page-container"},Cs={key:0,class:"enter-container"},As={class:"small"},Ts=f(" Have an account? "),Ls=f("Log in"),Ss={key:1,class:"enter-container"},Ps=p("h2",null,"Interested?",-1),Ds=f("Just "),Us=f(" how you you'd like to use the service, and we can send you an invitation!"),Is=p("p",null,"(While in beta, we are invitation-only, but we plan to be available for general use soon!)",-1),Fs=f("Learn more.");o();const Es=ks(((e,t,a,n,s,r)=>{const i=c("WelcomeMessage"),l=c("BaseForm"),o=c("router-link");return d(),u("div",xs,[p(i),e.allow_signups?(d(),u("div",Cs,[p(l,{title:"Sign up",fields:e.fields,submitText:"Sign up",action:r.signUp},null,8,["fields","action"]),p("p",As,[Ts,p(o,{to:{name:"login"}},{default:ks((()=>[Ls])),_:1})])])):(d(),u("div",Ss,[Ps,p("p",null,[Ds,p("a",{href:`mailto:${e.contact_email}?subject=Request%20A%20Capturing%20Account`},"let us know",8,["href"]),Us]),Is,p("p",null,[p(o,{to:{name:"docs"}},{default:ks((()=>[Fs])),_:1})])]))])}));ws.render=Es,ws.__scopeId="data-v-cba6fa52";const{mapActions:Ws}=i("user");var zs={components:{BaseForm:ts,WelcomeMessage:us},data:()=>({fields:[{name:"username",label:"Email"},{name:"password",type:"password"}]}),methods:r(r({},Ws(["login"])),{doLogin(e){return this.login(e).then((()=>window.location="/"))}})};const js={class:"container-full two-col login-page-container"},Hs={class:"enter-container"},Rs={class:"small"},qs=f(" Don't have an account? "),Ms=f("Sign up"),Os={class:"small"},$s=f(" Forgot your password? "),Bs=f("Reset password");zs.render=function(e,t,a,n,s,r){const i=c("WelcomeMessage"),l=c("BaseForm"),o=c("router-link");return d(),u("div",js,[p(i),p("div",Hs,[p(l,{title:"Log in",fields:e.fields,submitText:"Log in",action:r.doLogin},null,8,["fields","action"]),p("p",Rs,[qs,p(o,{to:{name:"sign_up"}},{default:v((()=>[Ms])),_:1})]),p("p",Os,[$s,p(o,{to:{name:"password_reset"}},{default:v((()=>[Bs])),_:1})])])])};var Vs={components:{TheMainHeader:ga}};const Zs={class:"container text-center"},Ns=p("div",null,"You have logged out.",-1),Ks=f("Log in again");Vs.render=function(e,t,a,n,s,r){const i=c("TheMainHeader"),l=c("router-link");return d(),u(m,null,[p(i,{head:"Logged out"}),p("div",Zs,[Ns,p("div",null,[p(l,{to:{name:"login"}},{default:v((()=>[Ks])),_:1})])])],64)};const{mapActions:Gs}=i("user");var Ys={components:{BaseForm:ts},data:()=>({fields:[{name:"old_password",type:"password"},{name:"new_password1",label:"New password",type:"password"},{name:"new_password2",label:"New password confirmation",type:"password"}]}),methods:r({},Gs(["changePassword"]))};Ys.render=function(e,t,a,n,s,r){const i=c("BaseForm");return d(),u(i,{title:"Change password",headingLevel:"2",fields:e.fields,action:e.changePassword,submitText:"Change password"},null,8,["fields","action"])};const{mapActions:Xs}=i("user");var Js={components:{BaseForm:ts},data:()=>({fields:[{name:"first_name"},{name:"last_name"},{name:"email",type:"email"}]}),methods:r({},Xs(["update"])),created(){for(const e of this.fields)e.value=this.$store.state.user[e.name]}};Js.render=function(e,t,a,n,s,r){const i=c("BaseForm");return d(),u(i,{fields:e.fields,action:e.update,title:"Profile",headingLevel:"2",submitText:"Update profile"},null,8,["fields","action"])};const{mapState:Qs,mapActions:er}=i("user");var tr={components:{TheUserForm:Js,ThePasswordChangeForm:Ys,BaseForm:ts},computed:Qs(["auth_token"]),methods:r({},er(["resetToken"]))};const ar={class:"container-full two-col account-page-container"},nr={class:"account-info"},sr={class:"api-info"};tr.render=function(e,t,a,n,s,r){const i=c("TheUserForm"),l=c("ThePasswordChangeForm"),o=c("BaseForm");return d(),u("div",ar,[p("div",nr,[p(i),p(l)]),p("div",sr,[p(o,{fields:[{name:"api-key",label:"Your API key",value:e.auth_token.key,readonly:!0}],action:e.resetToken,title:"API",headingLevel:"2",submitText:"Get a new key"},null,8,["fields","action"])])])};const{mapActions:rr}=i("user");var ir={components:{TheMainHeader:ga,BaseForm:ts},data:()=>({fields:[{name:"email",type:"email"}]}),methods:r({},rr(["resetPassword"]))};const lr={class:"container"},or={class:"row justify-content-center"};ir.render=function(e,t,a,n,s,r){const i=c("TheMainHeader"),l=c("BaseForm");return d(),u("div",lr,[p(i,{head:"Forgot your password?",subhead:"We'll email you instructions for setting a new one."}),p("div",or,[p(l,{fields:e.fields,action:e.resetPassword,submitText:"Reset my password",class:"col-lg-4 col-md-7 col-9"},null,8,["fields","action"])])])};const cr=[{path:"/",name:"root",component:ha},{path:"/docs/",name:"docs",component:va},{path:"/sign-up/",name:"sign_up",component:ws},{path:"/user/login/",name:"login",component:zs},{path:"/user/logout/",name:"logout",component:Vs},{path:"/user/account/",name:"account",component:tr},{path:"/user/password_reset/",name:"password_reset",component:ir},{path:"/user/password_change/",redirect:{name:"account"}},{path:"/user/password_change/done/",redirect:{name:"account"}}];var dr=U({history:I(),routes:cr});const ur=F(ue);ur.use(Le),ur.use(dr),ur.mount("#vue-app");
