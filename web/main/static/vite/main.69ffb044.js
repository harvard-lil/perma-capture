var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,n=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,r=(e,r)=>{for(var i in r||(r={}))t.call(r,i)&&n(e,i,r[i]);if(a)for(var i of a(r))s.call(r,i)&&n(e,i,r[i]);return e};import{c as i,p as o,a as l,r as c,o as d,b as u,d as p,t as h,F as m,e as g,w as b,f,g as y,h as v,i as w,j as _,k,l as C,m as x,n as A,v as L,q as T,s as S,u as U,x as P,y as D,z as j,A as F}from"./vendor.aaf8c599.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,r)=>{const i=new URL(e,s);if(self[t].moduleMap[i])return a(self[t].moduleMap[i]);const o=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){r(new Error(`Failed to import: ${e}`)),n(l)},onload(){a(self[t].moduleMap[i]),n(l)}});document.head.appendChild(l)})),self[t].moduleMap={}}}("/static/vite/");const{mapState:I,mapActions:R}=i("user");var W={computed:I(["first_name","is_authenticated","is_staff"]),methods:r(r({},R(["logout"])),{doLogout(e){return this.logout(e).then((()=>this.$router.push({name:"logout"})))}})};const E=f();o("data-v-8d91372a");const z={key:0,class:"dropdown"},H={class:"btn btn-secondary dropdown-toggle",type:"button",id:"dropdown-menu-nav","data-bs-toggle":"dropdown","aria-expanded":"false"},M={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"dropdown-menu-nav"},O=y("Dashboard"),$=y("My Account"),q=y("User Guide"),B=p("li",null,[p("hr",{class:"dropdown-divider"})],-1),V=p("li",null,[p("span",{class:"h6 dropdown-header"},"Admin Only")],-1),N=p("li",null,[p("a",{class:"dropdown-item",href:"/admin/"},"Django Admin")],-1),Z=p("li",null,[p("hr",{class:"dropdown-divider"})],-1),K=p("button",{type:"submit",class:"dropdown-item"},"Log out",-1),G={key:1,class:"navbar-nav"},J={class:"nav-item"},Y=y("Sign up"),X={class:"nav-item"},Q=y("User Guide"),ee={class:"nav-item"},te=y("Log in");l();const ae=E(((e,t,a,s,n,r)=>{const i=c("router-link");return e.is_authenticated?(d(),u("div",z,[p("button",H,h(e.first_name),1),p("ul",M,[p("li",null,[p(i,{to:{name:"root"},class:"dropdown-item"},{default:E((()=>[O])),_:1})]),p("li",null,[p(i,{to:{name:"account"},class:"dropdown-item"},{default:E((()=>[$])),_:1})]),p("li",null,[p(i,{to:{name:"docs"},class:"dropdown-item"},{default:E((()=>[q])),_:1})]),e.is_staff?(d(),u(m,{key:0},[B,V,N],64)):g("",!0),Z,p("li",null,[p("form",{onSubmit:t[1]||(t[1]=b(((...e)=>r.doLogout&&r.doLogout(...e)),["prevent"]))},[K],32)])])])):(d(),u("ul",G,[p("li",J,[p(i,{to:{name:"sign_up"},class:"nav-link"},{default:E((()=>[Y])),_:1})]),p("li",X,[p(i,{to:{name:"docs"},class:"nav-link"},{default:E((()=>[Q])),_:1})]),p("li",ee,[p(i,{to:{name:"login"},class:"nav-link"},{default:E((()=>[te])),_:1})])]))}));W.render=ae,W.__scopeId="data-v-8d91372a";i("globals");const se={components:{TheMainNav:W}},ne={class:"navbar navbar-expand-lg"},re={class:"container-fluid"},ie=p("img",{alt:"Perma logo",title:"Perma logo",src:"/static/vite/perma-logo.6b161a6e.svg"},null,-1),oe=p("span",{class:"wordmark"},"Perma Capture",-1);se.render=function(e,t,a,s,n,r){const i=c("router-link"),o=c("TheMainNav");return d(),u("nav",ne,[p("div",re,[p(i,{to:{name:"root"},class:"navbar-brand"},{default:v((()=>[ie,oe])),_:1}),p(o)])])};const le={name:"Footer"},ce={class:"page-footer"},de=w('<div><div class="attribution">Perma Capture is a project of the Harvard Law School <a href="https://lil.law.harvard.edu">Library Innovation Lab</a>.</div><div class="copyright">Â©2021 The President and Fellows of Harvard University.</div><a class="a11y-policy" href="https://accessibility.huit.harvard.edu/digital-accessibility-policy"><span aria-hidden="true">â™¿</span><span class="visually-hidden">Accessibility policy</span></a></div>',1);le.render=function(e,t,a,s,n,r){return d(),u("footer",ce,[de])};var ue=_({name:"App",components:{TheNavbar:se,TheFooter:le}});ue.render=function(e,t,a,s,n,r){const i=c("TheNavbar"),o=c("router-view"),l=c("TheFooter");return d(),u(m,null,[p(i),p("main",null,[p(o)]),p(l)],64)};var pe={namespaced:!0,state:r({},store_bootstrap.globals),getters:{},actions:{},mutations:{}};function he(e=""){return e.split("_").map((e=>e.slice(0,1).toUpperCase()+e.slice(1))).join("")}function me(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}let ge={"Content-Type":"application/json",Accept:"application/json"};const be=function(e){var t=null;if(document.cookie&&""!==document.cookie)for(var a=document.cookie.split(";"),s=0;s<a.length;s++){var n=a[s].trim();if(n.substring(0,e.length+1)===e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}return t}("csrftoken");be&&(ge["X-CSRFToken"]=be);const fe=k.create({headers:ge,paramsSerializer:e=>C.stringify(e,{arrayFormat:"comma"})});fe.interceptors.response.use((e=>{var t,a;return!1===(null==(a=null==(t=e.data)?void 0:t.form)?void 0:a.is_valid)?Promise.reject(e.data.form.errors):e}));var ye,ve,we,_e,ke,Ce,xe={namespaced:!0,state:r({},store_bootstrap.user),getters:{},actions:{signup:(e,t)=>fe.post("/sign-up/",t,{headers:{"Content-Type":"multipart/form-data"}}),update:({commit:e},t)=>fe.post("/user/account/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{e("update",t.data.form.data)})),login:(e,t)=>fe.post("/user/login/",t,{headers:{"Content-Type":"multipart/form-data"}}),logout:({commit:e})=>fe.post("/user/logout/",{headers:{"Content-Type":"multipart/form-data"}}).then((t=>{e("logout")})),resetPassword:(e,t)=>fe.post("/user/password_reset/",t,{headers:{"Content-Type":"multipart/form-data"}}),changePassword:(e,t)=>fe.post("/user/password_change/",t,{headers:{"Content-Type":"multipart/form-data"}}),resetToken:({commit:e})=>fe.post("/user/token_reset/").then((t=>{e("updateToken",t.data.token)}))},mutations:{update:(e,t)=>Object.assign(e,t),updateToken:(e,t)=>e.auth_token.key=t,logout:e=>e.is_authenticated=!1}};(ve=ye||(ye={}))[ve.Pending=0]="Pending",ve[ve.InProgress=1]="InProgress",(_e=we||(we={}))[_e.Invalid=0]="Invalid",_e[_e.Failed=1]="Failed",(Ce=ke||(ke={}))[Ce.Completed=0]="Completed";const Ae=e=>t=>(a,s)=>{if(t){const e=a;a=s,s=e}return a[e]<s[e]?-1:a[e]>s[e]?1:a.id<s.id?-1:a.id>s.id?1:0},Le={url:e=>{const t=Ae("url")(e);return(e,a)=>t(r(r({},e),{url:e.validated_url||e.requested_url}),r(r({},a),{url:a.validated_url||a.requested_url}))},created_at:e=>{const t=Ae("created_at")(e);return(e,a)=>t(r(r({},e),{created_at:new Date(e.created_at)}),r(r({},a),{created_at:new Date(a.created_at)}))}};var Te=x({modules:{globals:pe,user:xe,captures:{namespaced:!0,state:{all:[],apiContext:{count:null,next:null,previous:null}},getters:{getByProperties:e=>t=>e.all.find((e=>Object.keys(t).reduce(((a,s)=>a&&t[s]==e[s]),!0))),sortedBy:e=>(t,a=!0)=>e.all.sort((Le[t]||Ae(t))(a)),processing:e=>e.all.filter((e=>he(e.status)in ye))},actions:{list:({commit:e},t={ordering:"-created_at",limit:10})=>fe.get("/captures/",{params:t}).then((t=>{e("updateApiContext",t.data),e("replace",t.data.results)})),pageForward:({commit:e,state:t})=>fe.get(t.apiContext.next).then((t=>{e("updateApiContext",t.data),e("append",t.data.results)})),create:({commit:e},t)=>fe.post("/captures/",t).then((t=>{e("append",t.data)})),read:({commit:e,getters:t},a)=>fe.get(`/captures/${a.id}`).then((s=>{const n=t.getByProperties({id:a.id});n?e("update",{obj:n,vals:s.data}):e("append",[s.data])})),batchRead:({commit:e,getters:t},a)=>fe.get("/captures/",{params:{id__in:a.map((({id:e})=>e))}}).then((s=>{for(const[n,r]of s.data.results.entries()){const s=t.getByProperties({id:a[n].id});s?e("update",{obj:s,vals:r}):e("append",[r])}})),eagerCreateAndUpdate:({commit:e,getters:t},a)=>{e("append",a),fe.post("/captures/",a).then((s=>{for(const[n,r]of s.data.entries())e("update",{obj:t.getByProperties({created_at:a[n].created_at}),vals:r})}))}},mutations:{updateApiContext:(e,t)=>{return Object.assign(e.apiContext,(a=Object.keys(e.apiContext),s=t,a.reduce(((e,t)=>(e[t]=s[t],e)),{})));var a,s},replace:(e,t)=>e.all=t,append:(e,t)=>e.all.push(...t),update:(e,t)=>Object.assign(t.obj,t.vals),destroy:(e,t)=>e.all.splice(e.all.indexOf(t),1)}}},state:{displayedCapture:void 0,breakpoints:{xs:575,sm:767,md:991,lg:1199,xl:1399},windowWidth:"xl",viewportHeight:0},mutations:{setDisplayedCapture:(e,t)=>{e.displayedCapture=t},setWindowWidth:e=>{window.innerWidth<=e.breakpoints.xs?e.windowWidth="xs":window.innerWidth<=e.breakpoints.sm?e.windowWidth="sm":window.innerWidth<=e.breakpoints.md?e.windowWidth="md":window.innerWidth<=e.breakpoints.lg?e.windowWidth="lg":e.windowWidth="xl"},setViewportHeight:e=>{e.viewportHeight=Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},actions:{},getters:{displayedCapture:e=>e.displayedCapture,isMobile:e=>"md"===e.windowWidth||"sm"===e.windowWidth||"xs"===e.windowWidth,isSmallestScreen:e=>"xs"===e.windowWidth,viewportHeight:e=>e.viewportHeight}});const{mapActions:Se}=i("captures");var Ue={data:()=>({requested_urls:"",label:"",include_raw_exchanges:!1,include_screenshot:!0,include_pdf_snapshot:!1,include_dom_snapshot:!1,include_videos_as_attachment:!0,include_certificates_as_attachment:!0,run_site_specific_behaviors:!0,headless:!0}),computed:{formatted_urls(){return this.requested_urls.trim().split("\n")}},methods:r(r({},Se(["eagerCreateAndUpdate"])),{submit(){this.eagerCreateAndUpdate(this.formatted_urls.map((e=>({requested_url:e,label:this.label,include_raw_exchanges:this.include_raw_exchanges,include_screenshot:this.include_screenshot,include_pdf_snapshot:this.include_pdf_snapshot,include_dom_snapshot:this.include_dom_snapshot,include_videos_as_attachment:this.include_videos_as_attachment,include_certificates_as_attachment:this.include_certificates_as_attachment,run_site_specific_behaviors:this.run_site_specific_behaviors,headless:this.headless,created_at:(new Date).toISOString()})))),this.requested_urls="",this.label=""}})};const Pe={class:"form-content"},De=p("h1",null,"Create a capture for download",-1),je=p("h2",{class:"subtitle"},"Enter one or more URLs to capture it in a downloadable archive.",-1),Fe={class:"mb-3"},Ie={class:"mb-3"},Re={class:"mb-3 accordion",id:"advanced-options-wrapper"},We={class:"accordion-item"},Ee=p("div",{class:"accordion-header",id:"toggle-advanced-options"},[p("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#advanced-options","aria-expanded":"true","aria-controls":"advanced-options"}," Advanced Options ")],-1),ze={id:"advanced-options",class:"accordion-collapse collapse","aria-labelledby":"toggle-advanced-options","data-bs-parent":"#advanced-options-wrapper"},He={class:"accordion-body"},Me={clas:"form-check"},Oe=p("input",{name:"include_raw_exchanges",type:"hidden",value:"false"},null,-1),$e=p("label",{for:"include_raw_exchanges",class:"form-check-label"},"include raw exchanges",-1),qe={clas:"form-check"},Be=p("input",{name:"screenshot",type:"hidden",value:"false"},null,-1),Ve=p("label",{for:"include_screenshot",class:"form-check-label"},"include screenshot",-1),Ne={clas:"form-check"},Ze=p("input",{name:"include_pdf_snapshot",type:"hidden",value:"false"},null,-1),Ke=p("label",{for:"include_pdf_snapshot",class:"form-check-label"},"include PDF snapshot",-1),Ge={clas:"form-check"},Je=p("input",{name:"include_dom_snapshot",type:"hidden",value:"false"},null,-1),Ye=p("label",{for:"include_dom_snapshot",class:"form-check-label"},"include DOM snapshot",-1),Xe={clas:"form-check"},Qe=p("input",{name:"include_videos_as_attachment",type:"hidden",value:"false"},null,-1),et=p("label",{for:"include_videos_as_attachment",class:"form-check-label"},"include videos as attachments",-1),tt={clas:"form-check"},at=p("input",{name:"include_certificates_as_attachment",type:"hidden",value:"false"},null,-1),st=p("label",{for:"include_certificates_as_attachment",class:"form-check-label"},"include SSL certs as attachments",-1),nt={clas:"form-check"},rt=p("input",{name:"run_site_specific_behaviors",type:"hidden",value:"false"},null,-1),it=p("label",{for:"run_site_specific_behaviors",class:"form-check-label"},"run site-specific behaviors during capture",-1),ot={clas:"form-check"},lt=p("input",{name:"headless",type:"hidden",value:"false"},null,-1),ct=p("label",{for:"headless",class:"form-check-label"},"use a headless browser for capture",-1),dt=p("div",{class:"form-submit-container"},[p("button",{type:"submit",class:"btn btn-primary btn-create"},"Create"),p("span",{class:"warning-text"},[y("Captures expire "),p("u",null,"four hours"),y(" after creation.")])],-1);Ue.render=function(e,t,a,s,n,r){return d(),u("form",{ref:"form",class:"capture-form",onSubmit:t[11]||(t[11]=b(((...e)=>r.submit&&r.submit(...e)),["prevent"])),onKeydown:[t[12]||(t[12]=S(b(((...e)=>r.submit&&r.submit(...e)),["shift","exact","prevent"]),["enter"])),t[13]||(t[13]=S(b(((...e)=>r.submit&&r.submit(...e)),["meta","exact","prevent"]),["enter"]))]},[p("div",Pe,[De,je,p("div",Fe,[A(p("textarea",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.requested_urls=t),id:"requested_urls",class:"form-control",rows:"3",required:"",placeholder:"Enter one or more URLs on each line","aria-label":"Enter one or more URLs on each line"},null,512),[[L,e.requested_urls]])]),p("div",Ie,[A(p("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.label=t),"aria-label":"Label (Optional)",placeholder:"Label (Optional)",id:"label",type:"text",class:"form-control"},null,512),[[L,e.label]])]),p("div",Re,[p("div",We,[Ee,p("div",ze,[p("div",He,[p("div",Me,[Oe,A(p("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.include_raw_exchanges=t),id:"include_raw_exchanges",type:"checkbox",class:"form-check-input"},null,512),[[T,e.include_raw_exchanges]]),$e]),p("div",qe,[Be,A(p("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.include_screenshot=t),id:"include_screenshot",name:"include_screenshot",type:"checkbox",class:"form-check-input"},null,512),[[T,e.include_screenshot]]),Ve]),p("div",Ne,[Ze,A(p("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.include_pdf_snapshot=t),id:"include_pdf_snapshot",name:"include_pdf_snapshot",type:"checkbox",class:"form-check-input"},null,512),[[T,e.include_pdf_snapshot]]),Ke]),p("div",Ge,[Je,A(p("input",{"onUpdate:modelValue":t[6]||(t[6]=t=>e.include_dom_snapshot=t),id:"include_dom_snapshot",name:"include_dom_snapshot",type:"checkbox",class:"form-check-input"},null,512),[[T,e.include_dom_snapshot]]),Ye]),p("div",Xe,[Qe,A(p("input",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.include_videos_as_attachment=t),id:"include_videos_as_attachment",name:"include_videos_as_attachment",type:"checkbox",class:"form-check-input"},null,512),[[T,e.include_videos_as_attachment]]),et]),p("div",tt,[at,A(p("input",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.include_certificates_as_attachment=t),id:"include_certificates_as_attachment",name:"include_certificates_as_attachment",type:"checkbox",class:"form-check-input"},null,512),[[T,e.include_certificates_as_attachment]]),st]),p("div",nt,[rt,A(p("input",{"onUpdate:modelValue":t[9]||(t[9]=t=>e.run_site_specific_behaviors=t),id:"run_site_specific_behaviors",name:"run_site_specific_behaviors",type:"checkbox",class:"form-check-input"},null,512),[[T,e.run_site_specific_behaviors]]),it]),p("div",ot,[lt,A(p("input",{"onUpdate:modelValue":t[10]||(t[10]=t=>e.headless=t),id:"headless",name:"headless",type:"checkbox",class:"form-check-input"},null,512),[[T,e.headless]]),ct])])])])]),dt])],544)};const ut={name:"CaptureDetail",computed:{size(){return this.displayedCapture.archive?Number((this.displayedCapture.archive.size/1048576).toFixed(2)):0},expiresAt(){return this.displayedCapture.archive?new Date(this.displayedCapture.archive.download_expiration_timestamp):null},succeeded(){return he(this.displayedCapture.status||"pending")in ke},isMobile(){return this.$store.getters.isMobile},displayedCapture(){return this.$store.getters.displayedCapture}},methods:{getDate:e=>me(e),getArchiveAttribute(e){var t;return null==(t=this.displayedCapture)?void 0:t.archive[e]}}},pt={key:0,class:"capture-detail-container"},ht={key:0,class:"data-group"},mt=p("br",null,null,-1),gt={key:0},bt={key:1},ft={key:1,class:"data-group download-button-group"},yt={class:"float-end"},vt={class:"data-group"},wt=p("h3",{class:"h6"},"Requested URL",-1),_t={key:2,class:"data-group"},kt=p("h3",{class:"h6"},"Labels",-1),Ct={key:3,class:"data-group"},xt=p("h3",{class:"h6"},"Error Message",-1),At={class:"contextItem"},Lt={class:"alert alert-danger"},Tt={key:4,class:"data-group"},St=p("h3",{class:"h6"},"Screenshot",-1),Ut={key:5,class:"data-group"},Pt=p("h3",{class:"h6"},"Replay",-1),Dt={class:"iframe-container"},jt={key:6,class:"data-group"},Ft=p("h3",{class:"h6"},"Capture size",-1),It={key:7,class:"data-group"},Rt=p("h3",{class:"h6"},"Title",-1),Wt={key:8,class:"data-group"},Et=p("h3",{class:"h6"},"Description",-1),zt={key:9,class:"data-group"},Ht=p("h3",{class:"h6"},"Content Type",-1),Mt={key:10,class:"data-group"},Ot=p("h3",{class:"h6"},"Summary",-1);ut.render=function(e,t,a,s,n,r){return r.displayedCapture?(d(),u("div",pt,[r.isMobile?(d(),u("div",ht,[p("span",null,"Submitted "+h(r.getDate(r.displayedCapture.created_at)),1),mt,r.getArchiveAttribute("download_url")?(d(),u("span",gt,"Expires "+h(r.getDate(r.expiresAt)),1)):r.succeeded?(d(),u("span",bt,"Expired "+h(r.getDate(r.expiresAt)),1)):g("",!0)])):(d(),u("div",ft,[p("span",yt,[r.getArchiveAttribute("download_url")?(d(),u("a",{key:0,class:"btn bi bi-download download-button",href:r.getArchiveAttribute("download_url")},null,8,["href"])):g("",!0)])])),p("div",vt,[wt,p("a",{href:r.displayedCapture.validated_url},h(r.displayedCapture.requested_url),9,["href"])]),r.displayedCapture.label?(d(),u("div",_t,[kt,p("p",null,h(r.displayedCapture.label),1)])):g("",!0),r.displayedCapture.message?(d(),u("div",Ct,[xt,p("div",At,[p("div",Lt,h(r.displayedCapture.message),1)])])):g("",!0),r.getArchiveAttribute("screenshot_url")&&!r.getArchiveAttribute("download_url")?(d(),u("div",Tt,[St,p("img",{class:"screenshot",src:r.getArchiveAttribute("screenshot_url")},null,8,["src"])])):g("",!0),r.getArchiveAttribute("download_url")?(d(),u("div",Ut,[Pt,p("div",Dt,[p("replay-web-page",{source:r.getArchiveAttribute("download_url"),url:r.displayedCapture.validated_url,replaybase:"/replay/",class:"replay contextItem"},null,8,["source","url"])])])):g("",!0),r.size?(d(),u("div",jt,[Ft,p("p",null,h(r.size)+"MB",1)])):g("",!0),r.getArchiveAttribute("title")?(d(),u("div",It,[Rt,p("p",null,h(r.getArchiveAttribute("title")),1)])):g("",!0),r.getArchiveAttribute("description")?(d(),u("div",Wt,[Et,p("p",null,h(r.getArchiveAttribute("description")),1)])):g("",!0),r.getArchiveAttribute("target_url_content_type")?(d(),u("div",zt,[Ht,p("p",null,h(r.getArchiveAttribute("target_url_content_type")),1)])):g("",!0),r.getArchiveAttribute("summary")?(d(),u("div",Mt,[Ot,p("pre",null,h(r.getArchiveAttribute("summary")),1)])):g("",!0)])):g("",!0)};const{mapActions:$t}=i("captures");var qt={components:{CaptureDetail:ut},props:["capture"],data:()=>({displayDetails:!1}),computed:{statusOrDefault(){return he(this.capture.status||"pending")},isProcessing(){return this.statusOrDefault in ye},succeeded(){return this.statusOrDefault in ke},get_title(){var e;let t;switch(this.statusOrDefault){case"Invalid":t="Invalid URL";break;case"InProgress":t="Capture In Progress";break;case"Failed":t="Capture Failed";break;case"Completed":t=(null==(e=this.capture)?void 0:e.archive.title)||"Capture Completed";break;default:t="Capture Pending"}return t},url(){return this.capture.validated_url||this.capture.requested_url},downloadUrl(){return this.capture.archive?this.capture.archive.download_url:null},expiresAt(){return this.capture.archive?new Date(this.capture.archive.download_expiration_timestamp):null},isMobile(){return this.$store.getters.isMobile}},watch:{"$store.getters.displayedCapture":function(e){e&&e.id===this.capture.id||(this.displayDetails=!1)}},methods:r(r({},$t(["read"])),{toggleCaptureDetails(e){this.displayDetails=!this.displayDetails,this.displayDetails?Te.commit("setDisplayedCapture",e):Te.commit("setDisplayedCapture",void 0)},getDate:e=>me(e),shortenUrl:e=>e.length<=100?e:e.slice(0,100)+"..."})};const Bt={class:"content"},Vt=p("div",{class:"favicon","aria-hidden":"true"},"ðŸ”—",-1),Nt={class:"h6 capture-title"},Zt={class:"btn-group spinner"},Kt={key:0,class:"status-icon spinner spinner-border spinner-border-sm","aria-hidden":"true"},Gt={key:1,class:"btn bi bi-download download-button placeholder"},Jt={key:1,class:"capture-url"},Yt={class:"secondary-text recorded-date"},Xt=y("Â  "),Qt={key:0,class:"warning-text expired-date"},ea={key:1,class:"expired-date"};qt.render=function(e,t,a,s,n,r){const i=c("capture-detail");return d(),u("li",{class:[{active:r.isProcessing||r.downloadUrl,"details-shown":e.displayDetails},"capture-list-item"]},[p("div",Bt,[Vt,p("h3",Nt,h(r.get_title),1),p("div",Zt,[r.isProcessing?(d(),u("span",Kt)):(d(),u(m,{key:1},[r.downloadUrl?(d(),u("a",{key:0,class:"btn bi bi-download download-button",href:r.downloadUrl},null,8,["href"])):(d(),u("span",Gt)),p("button",{class:["btn bi bi-chevron-right replay-toggle",{active:e.displayDetails}],onClick:t[1]||(t[1]=e=>r.toggleCaptureDetails(a.capture))},null,2)],64))]),"Invalid"===r.statusOrDefault?(d(),u("span",{key:0,class:"capture-url",textContent:h(r.shortenUrl(r.url))},null,8,["textContent"])):(d(),u("span",Jt,[p("a",{href:r.url,textContent:h(r.shortenUrl(r.url))},null,8,["href","textContent"])])),p("span",Yt,"Submitted "+h(r.getDate(a.capture.created_at)),1),Xt,r.isProcessing?g("",!0):(d(),u(m,{key:2},[r.downloadUrl?(d(),u("span",Qt,"Expires "+h(r.getDate(r.expiresAt)),1)):r.succeeded?(d(),u("span",ea,"Expired "+h(r.getDate(r.expiresAt)),1)):g("",!0)],64)),r.isMobile&&e.displayDetails&&a.capture.id===e.$store.getters.displayedCapture.id?(d(),u(i,{key:3})):g("",!0)])],2)};const{mapGetters:ta,mapActions:aa,mapState:sa}=i("captures");var na={poller:null,components:{CaptureListItem:qt},data:()=>({loading:!0,sortBy:"created_at",sortDesc:!0,headings:{status:"Status",url:"URL",label:"Label",created_at:"Created At"},scrollable:!1,scrolled:!1}),computed:r(r(r({},ta({processing:"processing",captures:"sortedBy"})),sa({apiContext:"apiContext"})),{apiParams(){return{ordering:(this.sortDesc?"-":"")+this.sortBy}}}),methods:r(r({},aa(["list","pageForward","batchRead"])),{pollForProcessingChanges(){this.$options.poller=setInterval((()=>{this.batchRead(this.processing)}),3e3)},clearProcessingPoll(){clearInterval(this.$options.poller)},clearLazyLoadListeners(){this.$refs.captureList.removeEventListener("scroll",this.handleLazyLoad),window.removeEventListener("scroll",this.handleLazyLoad)},handleLazyLoad(e){let t=this.$refs.captureList,a=this.$store.getters.isSmallestScreen&&t.getBoundingClientRect().bottom<window.innerHeight,s=!this.$store.getters.isSmallestScreen&&t.scrollHeight-Math.abs(t.scrollTop)===t.clientHeight;(a||s)&&(this.clearLazyLoadListeners(),this.loading=!0,this.pageForward().then((()=>this.loading=!1)))},checkIsScrollable(){this.$nextTick((function(){!this.$store.getters.isSmallestScreen&&this.$refs.captureList.scrollHeight>=.8*this.$store.getters.viewportHeight?this.scrollable=!0:this.scrollable=!1}))},applyScrollStyles(e){e.target.scrollTop>0?this.scrolled=!0:this.scrolled=!1},changeSort(e){this.sortBy==e?this.sortDesc=!this.sortDesc:(this.sortBy=e,this.sortDesc=!0)}}),watch:{apiParams:{deep:!0,handler(){this.list(this.apiParams)}},apiContext:{deep:!0,handler(e,t){e.next?(this.$refs.captureList.addEventListener("scroll",this.handleLazyLoad),window.addEventListener("scroll",this.handleLazyLoad)):this.clearLazyLoadListeners()}},processing(e,t){this.$options.poller?e.length||this.clearProcessingPoll():e.length&&this.pollForProcessingChanges()}},created(){this.list().then((()=>this.loading=!1))},mounted(){this.$nextTick((function(){window.addEventListener("resize",this.checkIsScrollable)}))},updated(){this.$nextTick((function(){this.checkIsScrollable()}))},beforeUnmount(){this.clearProcessingPoll(),this.clearLazyLoadListeners(),window.removeEventListener("resize",this.checkIsScrollable)}};const ra=f();o("data-v-d4920d5a");const ia={class:"captures-list"},oa=p("header",{class:"captures-header"},[p("h2",{class:"list-title"},"Capture history")],-1),la={key:0,class:"capture-list-loading"};l();const ca=ra(((e,t,a,s,n,r)=>{const i=c("CaptureListItem");return d(),u("div",ia,[oa,p("ul",{ref:"captureList",class:{scrollable:e.scrollable,scrolled:e.scrolled},onScroll:t[1]||(t[1]=(...e)=>r.applyScrollStyles&&r.applyScrollStyles(...e))},[(d(!0),u(m,null,U(e.captures(e.sortBy,e.sortDesc),(e=>(d(),u(i,{key:e.id,capture:e},null,8,["capture"])))),128)),e.loading?(d(),u("li",la,"Loading...")):g("",!0)],34)])}));na.render=ca,na.__scopeId="data-v-d4920d5a";const{mapState:da}=i("globals");var ua={components:{CaptureForm:Ue,CaptureList:na,CaptureDetail:ut},computed:r({isMobile(){return this.$store.getters.isMobile},displayedCapture(){return this.$store.getters.displayedCapture}},da({rwp_base_url:"rwp_base_url"})),mounted(){this.$store.commit("setWindowWidth"),this.$store.commit("setViewportHeight"),this.$nextTick((()=>{window.addEventListener("resize",function(e,t=500){let a;return()=>{let s=arguments;clearTimeout(a),a=setTimeout((()=>{e.apply(this,s)}),t)}}((()=>{this.$store.commit("setWindowWidth"),this.$store.commit("setViewportHeight")}),250))}));const e=document.createElement("script");e.setAttribute("src",this.rwp_base_url+"/ui.js"),document.head.appendChild(e)}};ua.render=function(e,t,a,s,n,r){const i=c("CaptureForm"),o=c("CaptureList"),l=c("capture-detail");return d(),u("div",{class:["capture-dashboard container",{"capture-detail":!e.$store.getters.isMobile&&r.displayedCapture}]},[p(i),p(o),r.isMobile?g("",!0):(d(),u(l,{key:0}))],2)};const{mapState:pa}=i("user");var ha={components:{TheDashboard:ua},computed:pa(["is_authenticated"]),beforeMount(){this.is_authenticated||this.$router.push({name:"login"})}};const ma={class:"container-full root-page-container"};ha.render=function(e,t,a,s,n,r){const i=c("TheDashboard");return d(),u("div",ma,[e.is_authenticated?(d(),u(i,{key:0})):g("",!0)])};var ga={props:{head:{type:String},subhead:{type:String},center:{type:Boolean,default:!0}}};const ba=f()(((e,t,a,s,n,r)=>(d(),u(m,null,[p("h1",{class:[{"text-center":a.center},"main-header"]},h(a.head),3),a.subhead?(d(),u("p",{key:0,class:[{"text-center":a.center},"main-subheader"]},h(a.subhead),3)):g("",!0)],64))));ga.render=ba,ga.__scopeId="data-v-aac6d7cc";const{mapState:fa}=i("globals");var ya={components:{TheMainHeader:ga},data:()=>({sw_path:"",auth_token_key:"your-api-key"}),computed:r({base_url:()=>{}},fa({rwp_base_url:"rwp_base_url"})),mounted(){const e=document.createElement("script");e.setAttribute("src",this.rwp_base_url+"/ui.js"),document.head.appendChild(e)}};const va={class:"container-full docs-page-container"},wa={class:"docs container"},_a=w('<ul class="table-of-contents"><li><a href="#capturing-urls">Capturing URLs</a><ul><li><a href="#capturing-ui">Using the Web Interface</a></li><li><a href="#capturing-api">Using the API</a><ul><li><a href="#capturing-auth">Authorization</a></li><li><a href="#capturing-endpoints">Endpoints</a></li></ul></li><li><a href="#capturing-advanced-features">Advanced Features</a><ul><li><a href="#webhook-notifications">Webhooks</a></li><li><a href="#zapier-integration">Zapier Integration</a></li></ul></li><li><a href="#capturing-under-development">Features in Development</a><ul><li>Archive Hashes</li></ul></li></ul></li><li><a href="#viewing-captured-urls">Viewing Captured URLs</a><ul><li><a href="#embed-instructions">How to Embed</a></li><li><a href="#embed-examples">Examples</a><ul><li>Glitch</li></ul></li></ul></li></ul>',1),ka={class:"content"},Ca=p("p",{class:"lead"},[y("The Perma.cc capture system is built on "),p("a",{href:"https://github.com/webrecorder"},"Webrecorder"),y(" technology and uses an automated browser to produce high-fidelity web archives.")],-1),xa=p("p",null,[y("A "),p("a",{href:"https://github.com/webrecorder/wacz-format"},"web archive file"),y(' is created for each submitted URL, and each archive can be downloaded, embedded in a web page and displayed ("replayed") by any '),p("a",{href:"https://caniuse.com/serviceworkers"},"modern browser"),y(".")],-1),Aa=p("h2",{id:"capturing-urls"},"Capturing URLs",-1),La=p("h3",{id:"capturing-ui"},"Using the Web Interface",-1),Ta=y("After logging in, simply "),Sa=y("enter the URLs"),Ua=y(' you\'d like to preserve and click "Capture." A capture job will be launched for each submitted URL. '),Pa=p("p",null,[y("A list of all your active capture jobs will appear beneath the form. When each job is finished, you can click "),p("img",{style:{width:"1.5em",height:"1.5em","vertical-align":"top"},alt:"the preview button",title:"Preview Capture",src:"/static/vite/preview.e6fb6c31.svg"}),y(" to preview the capture, and "),p("img",{style:{width:"1.1em",height:"1.1em"},alt:"the download button",title:"Download Capture",src:"/static/vite/download.8d047fcf.svg"}),y(" to download the web archive file. ")],-1),Da=p("p",null,[p("img",{style:{"max-width":"100%"},src:"/static/vite/dashboard-screenshot.fe6ece90.png",alt:"Screenshot of the dashboard. The 'create a new archive' form is above a list of 2 capture jobs, with their download and preview buttons circled."})],-1),ja=p("p",null,"Capture jobs are retained for 4 hours and then are automatically deleted. Deleted capture jobs cannot be recovered from the service.",-1),Fa=p("p",null,[y("Read more about other options under "),p("a",{href:"#capturing-advanced-features"},"advanced features"),y(" and "),p("a",{href:"#capturing-under-development"},"features in development"),y(".")],-1),Ia=p("h3",{id:"capturing-api"},"Using the API",-1),Ra={key:0},Wa=y("Your API Key is "),Ea=p("h4",{id:"capturing-auth"},"Authorization ",-1),za=y("All registered users receive an "),Ha=y("API key"),Ma=y(". Every request to the API must be authenticated by providing that key as part of the "),Oa=p("code",null,"Authorization",-1),$a=y(" header: "),qa=p("h4",{id:"capturing-endpoints"},"Endpoints",-1),Ba=y("You can create archives programmatically by sending an HTTP "),Va=p("code",null,"POST",-1),Na=y(" to "),Za=y("."),Ka=p("p",null,[y("Required data (JSON-formatted): "),p("code",null,'"urls"'),y(" (a list of URLs to capture, each explicitly prefixed by "),p("code",null,"http"),y(" or "),p("code",null,"https"),y(").")],-1),Ga=p("p",null,[y("Optionally, you may also specify a "),p("code",null,'"tag"'),y(" (a nickname for this batch of URLs, for your convenience). If you are subscribed to "),p("a",{href:"#webhook-notifications"},"webhook notifications"),y(", you may also optionally specify a "),p("code",null,'"userDataField"'),y(" for your convenience (a string you would like included, verbatim, in the webhook notification response).")],-1),Ja=p("p",null,[y("Here's a request to archive a small batch of two URLs using "),p("code",null,"curl"),y(":")],-1),Ya=p("p",null,"The response, on success, will be a JSON dictionary including a jobid for each submitted URL:",-1),Xa=p("pre",null,[p("code",null,'{"urls": 2, "jobids": ["uuid4-1", "uuid4-2"]}')],-1),Qa=y("You can then query "),es=y(" to see all the capture jobs you have in the system:"),ts=p("p",null,"Sample Response:",-1),as=p("pre",null,[p("code",null,'\n        {\n          "jobs": [{\n            "jobid": "uuid4-1",\n            "userid": "3",\n            "captureUrl": "https://twitter.com/permacc",\n            "useEmbeds": false,\n            "userTag": "my-batch",\n            "startTime": "2020-09-28T23:54:19+00:00",\n            "elapsedTime": "2020-09-28T23:56:45+00:00",\n            "accessUrl": null,\n            "status": "In progress"\n          }, {\n            "jobid": "uuid4-2",\n            "userid": "3",\n            "captureUrl": "https://example.com/",\n            "useEmbeds": false,\n            "userTag": "my-batch",\n            "startTime": "2020-09-28T23:54:19+00:00",\n            "elapsedTime": "2020-09-28T23:54:39+00:00",\n            "status": "Complete",\n            "accessUrl": "https://permacaptures.example.com/path/to/download/mycapture.wacz"\n          }]\n        }\n        ')],-1),ss=p("p",null,[y("The response will list all active capture jobs created by your account. Each job will have a "),p("code",null,'"status"'),y(" field, set to either "),p("code",null,"In progress"),y(", "),p("code",null,"Failed"),y(", or "),p("code",null,"Complete"),y(".")],-1),ns=p("p",null,[y("A job that is "),p("code",null,"In progress"),y(" should be monitored until it is "),p("code",null,"Complete"),y(". (Or, if you'd like to be notified when a job is complete, check out "),p("a",{href:"#webhook-notifications"},"webhook notifications"),y(".) A "),p("code",null,"Failed"),y(" job indicates a permanent failure to produce a capture: you may wish to retry.")],-1),rs=p("p",null,[y("A job that is "),p("code",null,"Complete"),y(" will have an "),p("code",null,"accessUrl"),y(" set to a downloadable URL. The download URL is valid for 4 hours after the job is completed.")],-1),is=p("p",null,[y("All information about a capture job is automatically deleted after 4 hours. (Learn more about the "),p("a",{href:"#archive-hashes"},"information we retain"),y(".)")],-1),os=p("p",null,[y("Read more about other options under "),p("a",{href:"#capturing-advanced-features"},"advanced features"),y(" and "),p("a",{href:"#capturing-under-development"},"features in development"),y(".")],-1),ls=p("h3",{id:"capturing-advanced-features"},"Advanced Features",-1),cs=p("h4",{id:"webhook-notifications"},"Webhook Notifications",-1),ds=p("p",null,[y("We can notify you when your capture jobs are complete by sending an HTTP "),p("code",null,"POST"),y("to a callback URL you specify.")],-1),us=y("To subscribe to the "),ps=p("code",null,"ARCHIVE_CREATED",-1),hs=y(" event, "),ms=p("code",null,"POST",-1),gs=y(" your callback URL to "),bs={href:"/webhooks/"},fs=y("."),ys=p("p",null,[y("We'll send back a subscription "),p("code",null,"id"),y(", as well as a "),p("code",null,"signingKey"),y(" and "),p("code",null,"signingKeyAlgorithm"),y(" that you can optionally use to verify that any "),p("code",null,"POST"),y(" received by your callback URL is really from us.")],-1),vs=p("pre",null,[p("code",null,'\n        {\n          "id": 53,\n          "user": 3,\n          "eventType": "ARCHIVE_CREATED",\n          "signingKey": "a-128-character-key"\n          "signingKeyAlgorithm": "sha256"\n        }\n        ')],-1),ws=p("p",null,"You can subscribe as many times as you like, if you'd like multiple callback URLs to be notified.",-1),_s=p("p",null,[y("When an archive you request is complete, we'll make a "),p("code",null,"POST"),y(" to your callback like the following: ")],-1),ks=p("pre",null,[p("code",null,'\n        {\n          "userid": 3,\n          "jobid": "uuid4-1",\n          "url": "http://cnn.com",\n          "accessUrl": "https://permacaptures.example.com/path/to/download/mycapture.wacz",\n          "userDataField": ""\n        }\n        ')],-1),Cs=p("p",null,[y("We will include the signature in the "),p("code",null,"X-Hook-Signature"),y(" header.")],-1),xs=p("p",null,"If you want to verify the signature before acting, here's how to do it in Python:",-1),As=p("pre",null,[p("code",null,"\n          import hmac\n          import urllib\n          def is_valid_signature(signature, data, signing_key, signing_key_algorithm):\n            return hmac.compare_digest(\n              signature,\n              hmac.new(\n              bytes(signing_key, 'utf-8'),\n              bytes(urllib.parse.urlencode(data, doseq=True), 'utf-8'),\n              signing_key_algorithm\n            ).hexdigest()\n          )\n        ")],-1),Ls=p("p",null,"...and JavaScript:",-1),Ts=p("pre",null,[p("code",null,"\n        const crypto = require('crypto');\n        const querystring = require('querystring');\n\n        function isValidSignature(signature, data, signingKey, signingKeyAlgorithm){\n          const postedSignature = Buffer.from(signature, 'utf-8');\n          const generatedSignature = Buffer.from(\n            crypto.createHmac(signingKeyAlgorithm, signingKey).update(querystring.stringify(data)).digest('hex'),\n            'utf-8'\n          );\n          try {\n            return crypto.timingSafeEqual(postedSignature, generatedSignature);\n          } catch (e) {\n            return false;\n          }\n        }\n        ")],-1),Ss=p("p",null,"If you no longer wish to receive notifications, you can delete your subscription:",-1),Us=p("h4",{id:"zapier-integration"},"Zapier Integration",-1),Ps=p("p",null,[p("a",{href:"https://zapier.com"},"Zapier"),y(" users can integrate the Perma.cc capture service in their workflows. ")],-1),Ds=p("p",null,[y("For example, using this Zap, you can "),p("a",{href:"https://zapier.com/shared/3ee9336c0d9734d9fe6cc86e672b530f8336e93b"},"archive a URL straight from Slack"),y(", and this Zap will follow up, posting a "),p("a",{href:"https://zapier.com/app/editor/108033832/nodes/108033832"},"link to the completed archive as a reply"),y(", when it's finished.")],-1),js=p("p",null,[p("img",{style:{"max-width":"100%"},src:"/static/vite/slack-screenshot.46ab25e6.png",alt:"Screenshot of Slack, showing a capture request and a threaded reply with a link to the archive."})],-1),Fs=p("p",null,[y("This Zap, on the other hand, will post to a pre-configured Slack channel of your choice whenever "),p("a",{href:"https://zapier.com/shared/e1ccf1faa9b236b2317b85b46f0a643e8259aa77"},"an archive created by your account is ready to be downloaded"),y(".")],-1),Is=p("p",null,"Let us know if you are interested in a Zapier integration, and we'll help you get started!",-1),Rs=p("p",null,[y("Note: Zapier does not support "),p("a",{href:"http://resthooks.org/docs/security/"},"signature validation"),y(", instead relying on the privacy of subscription URLs for security. If you need to further verify the authenticity of data triggering your workflows, we recommend working with our webhooks directly.")],-1),Ws=p("h3",{id:"capturing-under-development"},"Features in Development",-1),Es=p("h4",{id:"archive-hashes"},"Archive Hashes",-1),zs=p("p",null,[y("We maintain a "),p("code",null,"sha-256"),y(" hash of every web archive file produced by the service, along with the timestamp of its production and the user id of the requesting user. We don't store any other metadata about capture jobs, including the target URL.")],-1),Hs=p("p",null,[y("We selected "),p("code",null,"sha256"),y(", despite its known limitations, because we wanted the algorithm to be "),p("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest"},"supported in JavaScript"),y(", and we weren't sure it was reasonable to expect users attempting to verify file hashes to manually calculate "),p("code",null,"sha512/256"),y(".")],-1),Ms=p("p",null,"Let us know if that sounds correct to you!",-1),Os=p("hr",null,null,-1),$s=p("h2",{id:"viewing-captured-urls"},"Viewing Captured URLs",-1),qs=p("p",null,[y("The downloadable WACZ files can be embedded in your site using the "),p("a",{href:"https://replayweb.page"},"ReplayWeb.page"),y(" embed system, loaded directly from NPM.")],-1),Bs=p("h3",{id:"embed-instructions"},"How to Embed",-1),Vs=y("The replay system requires you to host a single JavaScript file on your server, which visitors browsers will use to install the service worker that handles playbacks. We recommend putting it in an empty directory, for example at "),Ns=p("code",null,"/replay/sw.js",-1),Zs=y(". This file must be named "),Ks=p("code",null,"sw.js",-1),Gs=y(", and it should contain the following: "),Js=y("Each page that will contain embedded archives should include the following script and should also set the height for the "),Ys=p("code",null,"replay-web-page",-1),Xs=y(" tag to ensure a minimum height. (600px is used as an example here). "),Qs=p("li",null,[y("For each web archive/WACZ you'd like to embed, simply add the following HTML snippet: "),p("pre",null,[p("code",null,'\n            <replay-web-page\n              source="https://mysite.example.com/path/to/archives/mycapture.wacz"\n              url="https://example.com/"\n              replayBase="/replay/"\n            />\n            ')])],-1),en=p("p",null,[y("The "),p("code",null,"source"),y(" attribute should point to the URL of where the WACZ file is hosted, while the "),p("code",null,"url"),y(" is the URL captured. The "),p("code",null,"replayBase"),y(" is the path that contains the "),p("code",null,"sw.js"),y(" file. ("),p("code",null,"/replay/"),y(" in this example is also the default, and therefore could be omitted.)")],-1),tn=p("p",null,"The web server hosting WACZ files must support HTTP/1.1 range requests and be able to read portions of a file. If the WACZ file is hosted on a different domain than your site, CORS rules will also need to be enabled on the hosting server.",-1),an=p("h3",{id:"embed-examples"},"Example",-1),sn=p("p",null,"The following archive was created using this system:",-1),nn=p("ul",null,[p("li",null,[p("a",{href:"https://warcembed-demo.s3.amazonaws.com/twitter.com-2020-09-03.wacz"},"https://warcembed-demo.s3.amazonaws.com/twitter.com-2020-09-03.wacz")])],-1),rn=p("p",null,"We'll embed a replay of the archive using the following code:",-1),on=p("pre",null,[p("code",null,'\n          <replay-web-page\n            source="https://warcembed-demo.s3.amazonaws.com/twitter.com-2020-09-03.wacz"\n            url="https://twitter.com/dog_rates/status/1298052245209006086?s=20"\n            ></replay-web-page>\n        ')],-1),ln=p("replay-web-page",{style:{display:"block",height:"600px","margin-bottom":"1em"},source:"https://warcembed-demo.s3.amazonaws.com/twitter.com-2020-09-03.wacz",url:"https://twitter.com/dog_rates/status/1298052245209006086?s=20",replaybase:"/replay/"},null,-1),cn=y("The service worker is loaded from "),dn=y(". Since that's the default path, no further configuration is needed."),un=p("h4",null,"Glitch",-1),pn=p("p",null,[y("A fully stand-alone example of this embed is also available on "),p("a",{href:"https://permafact-demo.glitch.me/"},"Glitch"),y(".")],-1);ya.render=function(e,t,a,s,n,r){const i=c("TheMainHeader"),o=c("router-link");return d(),u("div",va,[p("div",wa,[_a,p("div",ka,[p(i,{head:"User Guide",center:!1}),Ca,xa,Aa,La,p("p",null,[Ta,p(o,{to:{name:"root"}},{default:v((()=>[Sa])),_:1}),Ua]),Pa,Da,ja,Fa,Ia,e.auth_token_key?(d(),u("p",Ra,[p("em",null,[Wa,p("code",null,h(e.auth_token_key),1)])])):g("",!0),Ea,p("p",null,[za,p(o,{to:{name:"account"}},{default:v((()=>[Ha])),_:1}),Ma,Oa,$a]),p("pre",null,[p("code",null,'curl -H "Authorization: Token '+h(e.auth_token_key)+'" '+h(r.base_url)+"...",1)]),qa,p("p",null,[Ba,Va,Na,p("code",null,h(r.base_url+"/captures/"),1),Za]),Ka,Ga,Ja,p("pre",null,[p("code",null,'\n        curl -X POST \\\n        -H "Content-Type: application/json" \\\n        -H "Authorization: Token '+h(e.auth_token_key)+'" \\\n        --data \'{ \\\n        "urls": [ \\\n          "https://twitter.com/permacc", \\\n          "https://example.com/" \\\n        ], \\\n        "tag": "my-batch", \\\n          "userDataField": "foo=bar&boo=baz" \\\n        }\' \\\n        '+h(r.base_url+"/captures/"),1)]),Ya,Xa,p("p",null,[Qa,p("code",null,h(r.base_url+"/captures/"),1),es]),p("pre",null,[p("code",null,'curl -H "Authorization: Token '+h(e.auth_token_key)+'" '+h(r.base_url+"/captures/"),1)]),ts,as,ss,ns,rs,is,os,ls,cs,ds,p("p",null,[us,ps,hs,ms,gs,p("a",bs,h(r.base_url+"/webhooks/"),1),fs]),p("pre",null,[p("code",null,'\n          curl -X POST \\\n          -H "Content-Type: application/json" \\\n          -H "Authorization: Token '+h(e.auth_token_key)+'" \\\n          --data \'{ \\\n            "callbackUrl": https://mysite.com/callback", \\\n            "eventType": "ARCHIVE_CREATED"\n          }\' \\\n          '+h(r.base_url+"/webhooks/")+"\n        ",1)]),ys,vs,ws,_s,ks,Cs,xs,As,Ls,Ts,Ss,p("pre",null,[p("code",null,'curl -X DELETE -H "Authorization: Token '+h(e.auth_token_key)+'" '+h(r.base_url+"/webhooks/53"),1)]),Us,Ps,Ds,js,Fs,Is,Rs,Ws,Es,zs,Hs,Ms,Os,$s,qs,Bs,p("ol",null,[p("li",null,[Vs,Ns,Zs,Ks,Gs,p("pre",null,[p("code",null,'importScripts("'+h(e.rwp_base_url)+'/sw.js");',1)])]),p("li",null,[Js,Ys,Xs,p("pre",null,[p("code",null,'\n              <script src="'+h(e.rwp_base_url)+'/ui.js"><\/script>\n              <style>\n                replay-web-page {\n                  height: 600px;\n                  display: flex;\n                }\n              </style>\n            ',1)])]),Qs]),en,tn,an,sn,nn,rn,on,ln,p("p",null,[cn,p("a",{href:e.sw_path},[p("code",null,h(e.sw_path),1)],8,["href"]),dn]),un,pn])])])};const{mapActions:hn}=i("user");var mn={props:{fields:Array,submitText:{type:String,default:"Submit"},action:Function,title:String,headingLevel:{type:Number,default:1}},data:()=>({processing:!1,displayValidations:!1,errors:{}}),computed:{fieldsWithDefaults(){return this.fields.map((e=>r({label:e.name.split("_").map(((e,t)=>t?e:e.charAt(0).toUpperCase()+e.slice(1))).join(" "),id:e.name+Date.now(),type:"text",readonly:!1,disabled:!1,required:!0},e)))},errorCount(){return Object.keys(this.errors).length}},watch:{errorCount(e){e&&this.displayValidations&&this.$nextTick((()=>this.$refs.errorsHeader.focus()))}},methods:r(r({},hn(["changePassword"])),{getFieldByName(e){return this.fieldsWithDefaults.find((t=>t.name==e))},checkValidity(e){e.target.checkValidity()&&delete this.errors[e.target.name]},onInvalid(e){this.errors[e.target.name]=[{message:e.target.validationMessage}]},collectFrontendErrors(){this.errors={},this.$el.querySelectorAll(":invalid").forEach((e=>this.errors[e.name]=[{message:e.validationMessage}]))},submit(e){this.collectFrontendErrors(),this.displayValidations=!0,0==this.errorCount&&(this.processing=!0,this.action(new FormData(e.target)).then((()=>this.displayValidations=!1)).catch((e=>this.errors=e)).then((()=>this.processing=!1)))}})};const gn={key:1,ref:"errorsHeader",tabindex:"-1",class:"invalid-field-summary alert alert-danger"},bn=y(" Please correct the following "),fn=y("error"),yn={key:1},vn=y(": "),wn={class:"invalid-field-list"},_n=y(": "),kn={class:"form-floating mb-3"},Cn={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};mn.render=function(e,t,a,s,n,r){return d(),u("form",{class:"base-form",onSubmit:t[3]||(t[3]=b(((...e)=>r.submit&&r.submit(...e)),["prevent"])),novalidate:""},[a.title?(d(),u("div",{key:0,role:"heading","aria-level":a.headingLevel,class:["form-heading mb-1","h"+a.headingLevel]},h(a.title),11,["aria-level"])):g("",!0),e.displayValidations&&r.errorCount?(d(),u("div",gn,[bn,1==r.errorCount?(d(),u(m,{key:0},[fn],64)):(d(),u("strong",yn,h(r.errorCount)+" errors",1)),vn,p("ul",wn,[(d(!0),u(m,null,U(e.errors,((e,t)=>(d(),u("li",null,["__all__"!=t?(d(),u(m,{key:0},[p("a",{class:"alert-link",href:"#"+r.getFieldByName(t).id},h(r.getFieldByName(t).label),9,["href"]),_n],64)):g("",!0),y(" "+h(e.map((({message:e})=>e)).join(", ")),1)])))),256))])],512)):g("",!0),(d(!0),u(m,null,U(r.fieldsWithDefaults,(a=>(d(),u("div",kn,[A(p("input",{"onUpdate:modelValue":e=>a.value=e,onBlur:t[1]||(t[1]=(...e)=>r.checkValidity&&r.checkValidity(...e)),onInvalid:t[2]||(t[2]=(...e)=>r.onInvalid&&r.onInvalid(...e)),placeholder:a.label,name:a.name,id:a.id,type:a.type,class:["form-control",{"is-invalid":e.displayValidations&&e.errors[a.name],"form-control-plaintext":a.readonly}],required:a.required,disabled:!0===a.disabled||e.processing,readonly:a.readonly,"aria-invalid":!!e.errors[a.name],"aria-describedby":(e.errors[a.name]||[]).map(((e,t)=>a.id+"InvalidFeedback"+t))},null,42,["onUpdate:modelValue","placeholder","name","id","type","required","disabled","readonly","aria-invalid","aria-describedby"]),[[P,a.value]]),p("label",{for:a.id,class:"form-label"},h(a.label),9,["for"]),(d(!0),u(m,null,U(e.errors[a.name],((e,t)=>(d(),u("div",{id:a.id+"InvalidFeedback"+t,class:"invalid-feedback"},h(e.message),9,["id"])))),256))])))),256)),p("button",{type:"submit",class:"btn btn-primary mt-1",disabled:e.processing},[e.processing?(d(),u("span",Cn)):g("",!0),y(" "+h(a.submitText),1)],8,["disabled"])],32)};const xn={name:"WelcomeMessage"},An=f();o("data-v-6355e12a");const Ln={class:"message"},Tn=p("h1",{class:"mb-4"},[y(" Websites change."),p("br"),p("span",{class:"blue-text"},"Perma Captures"),y(" don't. ")],-1),Sn=p("span",{class:"h5 subtitle mb-2"},"Perma Captures help scholars, newsrooms, researchers, and others create permanent records of the web.",-1),Un=p("span",{class:"h5 subtitle d-none d-sm-none d-md-block mb-4"},"Simply create a capture and download it for your records.",-1),Pn=p("img",{class:"d-none d-sm-none d-md-block",src:"/static/vite/welcome-graphic.bc1da09f.svg",alt:"Graphic showing that while websites change, Perma Captures don't."},null,-1);l();const Dn=An(((e,t,a,s,n,r)=>(d(),u("div",Ln,[Tn,Sn,Un,Pn]))));xn.render=Dn,xn.__scopeId="data-v-6355e12a";const{mapState:jn}=i("globals"),{mapActions:Fn}=i("user");var In={components:{BaseForm:mn,WelcomeMessage:xn},computed:jn(["app_name","contact_email","allow_signups"]),data:()=>({fields:[{name:"first_name",label:"First name"},{name:"last_name",label:"Last name"},{name:"email",label:"Email"}]}),methods:r(r({},Fn(["signup"])),{signUp(e){return this.signup(e).then((()=>window.location="/"))}})};const Rn=f();o("data-v-cba6fa52");const Wn={class:"container-full two-col login-page-container"},En={key:0,class:"enter-container"},zn={class:"small"},Hn=y(" Have an account? "),Mn=y("Log in"),On={key:1,class:"enter-container"},$n=p("h2",null,"Interested?",-1),qn=y("Just "),Bn=y(" how you you'd like to use the service, and we can send you an invitation!"),Vn=p("p",null,"(While in beta, we are invitation-only, but we plan to be available for general use soon!)",-1),Nn=y("Learn more.");l();const Zn=Rn(((e,t,a,s,n,r)=>{const i=c("WelcomeMessage"),o=c("BaseForm"),l=c("router-link");return d(),u("div",Wn,[p(i),e.allow_signups?(d(),u("div",En,[p(o,{title:"Sign up",fields:e.fields,submitText:"Sign up",action:r.signUp},null,8,["fields","action"]),p("p",zn,[Hn,p(l,{to:{name:"login"}},{default:Rn((()=>[Mn])),_:1})])])):(d(),u("div",On,[$n,p("p",null,[qn,p("a",{href:`mailto:${e.contact_email}?subject=Request%20A%20Capturing%20Account`},"let us know",8,["href"]),Bn]),Vn,p("p",null,[p(l,{to:{name:"docs"}},{default:Rn((()=>[Nn])),_:1})])]))])}));In.render=Zn,In.__scopeId="data-v-cba6fa52";const{mapActions:Kn}=i("user");var Gn={components:{BaseForm:mn,WelcomeMessage:xn},data:()=>({fields:[{name:"username",label:"Email"},{name:"password",type:"password"}]}),methods:r(r({},Kn(["login"])),{doLogin(e){return this.login(e).then((()=>window.location="/"))}})};const Jn={class:"container-full two-col login-page-container"},Yn={class:"enter-container"},Xn={class:"small"},Qn=y(" Don't have an account? "),er=y("Sign up"),tr={class:"small"},ar=y(" Forgot your password? "),sr=y("Reset password");Gn.render=function(e,t,a,s,n,r){const i=c("WelcomeMessage"),o=c("BaseForm"),l=c("router-link");return d(),u("div",Jn,[p(i),p("div",Yn,[p(o,{title:"Log in",fields:e.fields,submitText:"Log in",action:r.doLogin},null,8,["fields","action"]),p("p",Xn,[Qn,p(l,{to:{name:"sign_up"}},{default:v((()=>[er])),_:1})]),p("p",tr,[ar,p(l,{to:{name:"password_reset"}},{default:v((()=>[sr])),_:1})])])])};var nr={components:{TheMainHeader:ga}};const rr={class:"container text-center"},ir=p("div",null,"You have logged out.",-1),or=y("Log in again");nr.render=function(e,t,a,s,n,r){const i=c("TheMainHeader"),o=c("router-link");return d(),u(m,null,[p(i,{head:"Logged out"}),p("div",rr,[ir,p("div",null,[p(o,{to:{name:"login"}},{default:v((()=>[or])),_:1})])])],64)};const{mapActions:lr}=i("user");var cr={components:{BaseForm:mn},data:()=>({fields:[{name:"old_password",type:"password"},{name:"new_password1",label:"New password",type:"password"},{name:"new_password2",label:"New password confirmation",type:"password"}]}),methods:r({},lr(["changePassword"]))};cr.render=function(e,t,a,s,n,r){const i=c("BaseForm");return d(),u(i,{title:"Change password",headingLevel:"2",fields:e.fields,action:e.changePassword,submitText:"Change password"},null,8,["fields","action"])};const{mapActions:dr}=i("user");var ur={components:{BaseForm:mn},data:()=>({fields:[{name:"first_name"},{name:"last_name"},{name:"email",type:"email"}]}),methods:r({},dr(["update"])),created(){for(const e of this.fields)e.value=this.$store.state.user[e.name]}};ur.render=function(e,t,a,s,n,r){const i=c("BaseForm");return d(),u(i,{fields:e.fields,action:e.update,title:"Profile",headingLevel:"2",submitText:"Update profile"},null,8,["fields","action"])};const{mapState:pr,mapActions:hr}=i("user");var mr={components:{TheUserForm:ur,ThePasswordChangeForm:cr,BaseForm:mn},computed:pr(["auth_token"]),methods:r({},hr(["resetToken"]))};const gr={class:"container-full two-col account-page-container"},br={class:"account-info"},fr={class:"api-info"};mr.render=function(e,t,a,s,n,r){const i=c("TheUserForm"),o=c("ThePasswordChangeForm"),l=c("BaseForm");return d(),u("div",gr,[p("div",br,[p(i),p(o)]),p("div",fr,[p(l,{fields:[{name:"api-key",label:"Your API key",value:e.auth_token.key,readonly:!0}],action:e.resetToken,title:"API",headingLevel:"2",submitText:"Get a new key"},null,8,["fields","action"])])])};const{mapActions:yr}=i("user");var vr={components:{TheMainHeader:ga,BaseForm:mn},data:()=>({fields:[{name:"email",type:"email"}]}),methods:r({},yr(["resetPassword"]))};const wr={class:"container"},_r={class:"row justify-content-center"};vr.render=function(e,t,a,s,n,r){const i=c("TheMainHeader"),o=c("BaseForm");return d(),u("div",wr,[p(i,{head:"Forgot your password?",subhead:"We'll email you instructions for setting a new one."}),p("div",_r,[p(o,{fields:e.fields,action:e.resetPassword,submitText:"Reset my password",class:"col-lg-4 col-md-7 col-9"},null,8,["fields","action"])])])};const kr=[{path:"/",name:"root",component:ha},{path:"/docs/",name:"docs",component:ya},{path:"/sign-up/",name:"sign_up",component:In},{path:"/user/login/",name:"login",component:Gn},{path:"/user/logout/",name:"logout",component:nr},{path:"/user/account/",name:"account",component:mr},{path:"/user/password_reset/",name:"password_reset",component:vr},{path:"/user/password_change/",redirect:{name:"account"}},{path:"/user/password_change/done/",redirect:{name:"account"}}];var Cr=D({history:j(),routes:kr});const xr=F(ue);xr.use(Te),xr.use(Cr),xr.mount("#vue-app");
